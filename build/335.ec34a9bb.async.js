(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[335],{34950:function($,I){"use strict";Object.defineProperty(I,"__esModule",{value:!0});var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};I.default=e},3855:function($,I,e){"use strict";var k,H=e(95318),w=e(20862);k={value:!0},I.Z=void 0;var y=w(e(67294)),N=H(e(34950)),Q=H(e(92074)),F=function(t,X){return y.createElement(Q.default,Object.assign({},t,{ref:X,icon:N.default}))};F.displayName="ExclamationCircleOutlined";var J=y.forwardRef(F);I.Z=J},78863:function($){$.exports={formWrap:"formWrap___3eS8c",rowWrap:"rowWrap___3VEOz",description:"description___bi6uK"}},79920:function($){$.exports={formWrap:"formWrap___19ekr",rowWrap:"rowWrap___1jzhp",description:"description___2a_68"}},24342:function($,I,e){"use strict";var k=e(13378),H=e(56361),w=e(3911),y=e(67294),N=e(87542);I.Z=function(Q){var F=Q.value,J=F===void 0?[]:F,O=Q.onChange,t=(0,w.Z)(Q,["value","onChange"]),X={selectedRowKeys:J,onChange:function(_){O==null||O(_)}};return y.createElement(N.ZP,(0,k.Z)({rowSelection:(0,H.Z)((0,H.Z)({},X),{},{checkStrictly:!0})},t))}},34335:function($,I,e){"use strict";e.r(I),e.d(I,{default:function(){return We}});var k=e(13753),H=e(48429),w=e(14643),y=e(92909),N=e(68699),Q=e(26780),F=e(46567),J=e(94043),O=e.n(J),t=e(67294),X=e(87542),v=e(66594),_=e(49101),ne=e(96689),fe=e(31567),ze=e(58210),le=e(87240),ee=e(13378),je=e(97140),ve=e(93228),Ue=e(74393),he=e(88995),Ve=e(68137),W=e(50532),R=e(56361),Ke=e(67604),s=e(66498),q=e(44742),pe=e(47376),M=e(66827),re=e(84850),ge=e(3678),Ee=e(95951),ye=e(32615),Ce=e(3855),Ze=e(79920),Y=e.n(Ze),te=e(42348),Ie=e(35510),Fe=e.n(Ie),Ae=e(56051),oe=e.n(Ae),ae=e(27870),ue=e(48786),be=function(d){return d&&d<oe()().endOf("day")},ie={labelCol:{span:8},wrapperCol:{span:14}},Se={labelCol:{span:4},wrapperCol:{span:19}},De=function(n){var d=n.visible,C=n.toggleVisible,h=n.formData,p=n.reload,T=s.Z.useForm(),x=(0,q.Z)(T,1),g=x[0],u=(0,re.Z)(),P=u.tip,r=u.setTip,c=h.id,z=(0,ue.tT)("company"),A=z.reloadCompanyData,b=(0,M.QT)(API.platform.sysOrg.detail.fetch,{onSuccess:function(E){g.setFieldsValue((0,R.Z)((0,R.Z)({},E),{},{validBefore:E.validBefore?oe()(E.validBefore):null,logo:E!=null&&E.logo?[{uid:"1",name:"logo",status:"done",url:E==null?void 0:E.logo,size:0}]:[]}))},manual:!0}),i=b.run,Z=b.loading;(0,t.useEffect)(function(){return d&&c&&i({id:c}),function(){g.resetFields()}},[c,d]);var B=function(){C(),g.resetFields()},j=function(){y.default.success("\u4FDD\u5B58\u6210\u529F"),g.resetFields(),C(),p==null||p(),A()},U=(0,M.QT)(API.platform.sysOrg.update.fetch,{onSuccess:j,manual:!0}),S=U.run,G=U.loading,m=(0,M.QT)(API.platform.sysOrg.save.fetch,{onSuccess:j,manual:!0}),l=m.run,a=m.loading,o=function(E){r("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var ce=(0,ae.HO)((0,R.Z)((0,R.Z)((0,R.Z)({},h),E),{},{logo:E.logo.map(function(me){return me.url||me.response.data.url})[0]}));return c?S(ce):l(ce)},D=(0,M.QT)(o,{manual:!0}),V=D.run,L=D.loading,K=Z||L||G||a;return t.createElement(F.Z,{centered:!0,visible:d,forceRender:!0,maskClosable:!1,title:"".concat((0,pe.Z)(c)?"\u65B0\u5EFA":"\u7F16\u8F91","\u4F01\u4E1A"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return g.submit()},onCancel:B,confirmLoading:K},t.createElement(le.Z,{spinning:K,tip:P},t.createElement(s.Z,(0,ee.Z)({form:g,onFinish:V},ie,{className:Y().formWrap}),t.createElement(s.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"orgCode",tooltip:{icon:t.createElement(Ce.Z,null),title:`\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00
\u9700\u8981\u8F93\u516520\u4F4D\u4EE5\u5185\u5B57\u6BCD\uFF0C\u533A\u5206\u5927\u5C0F\u5199`},rules:[{whitespace:!0},{required:!0}]},t.createElement(W.Z,{disabled:!!c,placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(s.Z.Item,{label:"\u4F01\u4E1A\u540D\u79F0",name:"orgName",rules:[{whitespace:!0},{required:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:Y().rowWrap},t.createElement(ge.Z,{formItemProps:ie,label:"\u4F01\u4E1Alogo",name:"logo",maxCount:1,accept:Ee.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20"},t.createElement(ye.Z,null))),t.createElement("div",{className:Y().rowWrap},t.createElement(s.Z.Item,{label:"\u4F01\u4E1A\u4EE3\u7801",name:"enterpriseCode",rules:[{whitespace:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement(s.Z.Item,{label:"\u8D1F\u8D23\u4EBA",name:"director",rules:[{whitespace:!0},{required:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(s.Z.Item,{label:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{required:!0},{validator:te.tH}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),!!c&&t.createElement(s.Z.Item,{label:"\u7BA1\u7406\u5458\u8D26\u53F7",name:"directorUsername",rules:[{whitespace:!0},{validator:te.tH}]},t.createElement(W.Z,{disabled:!0,placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(s.Z.Item,{label:"\u6709\u6548\u671F",name:"validBefore",rules:[{required:!0}]},t.createElement(he.Z,{disabledDate:be})),!!c&&t.createElement(t.Fragment,null,t.createElement(s.Z.Item,{label:"\u72B6\u6001",name:"status",rules:[{whitespace:!0},{required:!0}]},t.createElement(ve.Z,{options:(0,ne.MM)(v.w6),placeholder:"\u8BF7\u9009\u62E9"})),t.createElement(s.Z.Item,{label:"\u5F53\u524D\u7528\u6237\u6570",name:"userNum",rules:[{whitespace:!0},{validator:te.tH}]},t.createElement(W.Z,{disabled:!0,placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement("div",{className:Fe()(Y().rowWrap,Y().description)},t.createElement(s.Z.Item,(0,ee.Z)({label:"\u63CF\u8FF0",name:"description",rules:[{whitespace:!0},{required:!0}]},Se),t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"}))))))},Oe=e(3911),se=e(46368),Re=e(78863),Me=e.n(Re),Te=e(96486),xe=e(24342),Pe={labelCol:{span:6},wrapperCol:{span:16}},Be=function(n){var d=n.visible,C=n.toggleVisible,h=n.formData,p=n.loading,T=n.reload,x=s.Z.useForm(),g=(0,q.Z)(x,1),u=g[0],P=(0,re.Z)(),r=P.tip,c=P.setTip,z=h.directorRoleId,A=(0,ue.tT)("resourceData"),b=A.resourceList,i=(0,M.QT)(function(l){return API.authorization.resource.listUserResourceData.fetch({clientKey:v.OW.clientId,roleId:l})},{manual:!0,onSuccess:function(a){var o=[];a.forEach(function(D){var V=D.id,L=D.privilegeList,K=L===void 0?[]:L;o.push(V),(0,se.Z)(K)||K.forEach(function(f){o.push(f.id)})}),u.setFieldsValue({resourceIds:o})}}),Z=i.run;(0,t.useEffect)(function(){d&&Z(z)},[d]),(0,t.useEffect)(function(){return(0,se.Z)(h)||u.setFieldsValue(h),function(){u.resetFields()}},[h]);var B=function(){C(),u.resetFields()},j=function(a){var o=a.resourceIds,D=o===void 0?[]:o,V=(0,Oe.Z)(a,["resourceIds"]);c("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var L=(0,ae.HO)((0,R.Z)((0,R.Z)({},V),{},{clientKey:v.OW.clientId,id:z,resourceIds:D.filter(function(K){return(0,Te.isNumber)(K)})}));return API.platform.sysRole.resourceSave.fetch(L)},U=(0,M.QT)(j,{manual:!0,onSuccess:function(){y.default.success("\u4FDD\u5B58\u6210\u529F"),u.resetFields(),C(),T==null||T()}}),S=U.run,G=U.loading,m=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"description",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u6807\u8BC6",dataIndex:"resourceKey",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"type",align:"left",copyable:!1,valueType:"text",render:function(a){return a===v.o4.\u8DEF\u7531\u7EA7\u8D44\u6E90?"\u8DEF\u7531\u7EA7\u8D44\u6E90":"\u9875\u9762\u7EA7\u8D44\u6E90"}}];return t.createElement(F.Z,{centered:!0,visible:d,forceRender:!0,maskClosable:!1,title:"\u4F01\u4E1A\u6388\u6743",okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return u.submit()},onCancel:B,confirmLoading:G},t.createElement(le.Z,{spinning:p&&G,tip:r},t.createElement(s.Z,(0,ee.Z)({form:u,onFinish:S},Pe,{className:Me().formWrap}),t.createElement(s.Z.Item,{label:"\u6743\u9650\u5217\u8868",name:"resourceIds",noStyle:!0},t.createElement(xe.Z,{search:!1,rowKey:"id",columns:m,dataSource:b})))))},de=e(89193),Le=function(){var n=(0,t.useRef)(),d=(0,de.x)({visible:!1,formData:{},loading:!1}),C=(0,q.Z)(d,2),h=C[0],p=C[1],T=(0,de.x)({visible:!1,formData:{},loading:!1}),x=(0,q.Z)(T,2),g=x[0],u=x[1],P=n.current||{},r=P.reload,c=(0,M.QT)(API.platform.sysOrg.resetPassword.fetch,{manual:!0,onSuccess:function(){y.default.success("\u91CD\u7F6E\u6210\u529F"),r==null||r()}}),z=c.run,A=(0,M.QT)(API.platform.sysOrg.updateStatus.fetch,{manual:!0,onSuccess:function(){y.default.success("\u64CD\u4F5C\u6210\u529F"),r==null||r()}}),b=A.run,i=(0,M.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){y.default.success("\u5220\u9664\u6210\u529F"),r==null||r()}}),Z=i.run,B=function(){var m=(0,N.Z)(O().mark(function l(a){var o,D,V,L;return O().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,API.platform.sysOrg.pageList.fetch((0,ae.HO)((0,R.Z)((0,R.Z)({},a),{},{page:(a==null?void 0:a.current)||v.ii.page,pageSize:(a==null?void 0:a.pageSize)||v.ii.pageSize})));case 2:return o=f.sent,D=o.list,V=o.page,L=o.total,f.abrupt("return",{data:D||[],page:V,success:!0,total:L});case 7:case"end":return f.stop()}},l)}));return function(a){return m.apply(this,arguments)}}(),j=function(l){p(function(a){a.visible=!0,a.loading=!0,a.formData=l})},U=function(){p(function(l){l.visible=!0,l.formData={}})},S=function(l){u(function(a){a.visible=!0,a.loading=!0,a.formData=l})},G=function(l){var a={edit:p,auth:u};a[l](function(o){o.visible=!1,o.loading=!1,o.formData={}})};return{actionRef:n,reload:r,editModalConfig:h,setEditModalConfig:p,authModalConfig:g,setAuthModalConfig:u,handleDelete:Z,fetchList:B,handleCompanyEdit:j,handleUpdateStatus:b,handleResetPassword:z,handleCompanyAdd:U,handleAuthorize:S,handleModalHide:G}},We=function(){var n=Le(),d=n.actionRef,C=n.reload,h=n.editModalConfig,p=n.fetchList,T=n.handleResetPassword,x=n.handleUpdateStatus,g=n.handleCompanyAdd,u=n.handleCompanyEdit,P=n.handleModalHide,r=n.authModalConfig,c=n.handleAuthorize,z=[{title:"\u4F01\u4E1A\u7F16\u7801",dataIndex:"orgCode",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA",dataIndex:"director",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,ne.BJ)(v.w6)},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"date",hideInSearch:!1,hideInTable:!0},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(b,i){return t.createElement(fe.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return u(i)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return c(i)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return F.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return i.id&&x({status:v.w6.\u7981\u7528,id:"".concat(i.id)})}})},hidden:v.w6.\u7981\u7528===+i.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var Z=(0,N.Z)(O().mark(function j(){return O().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",i.id&&x({status:v.w6.\u6B63\u5E38,id:"".concat(i.id)}));case 1:case"end":return S.stop()}},j)}));function B(){return Z.apply(this,arguments)}return B}(),hidden:v.w6.\u7981\u7528!==+i.status},{name:"\u91CD\u7F6E\u5BC6\u7801",key:"reset",onClick:function(){return F.Z.confirm({title:"\u786E\u8BA4\u91CD\u7F6E\u5BC6\u7801\uFF1F",onOk:function(){return i.id&&T({id:"".concat(i.id)})}})}}]})}}];return t.createElement(t.Fragment,null,t.createElement(X.ZP,{style:{padding:"18px 22px"},actionRef:d,request:p,onRequestError:function(b){console.error(b.message),y.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(b.message))},columns:z,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u4F01\u4E1A\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(H.Z,{onClick:g,key:"add",type:"primary"},t.createElement(_.Z,null),"\u65B0\u5EFA")]}}),t.createElement(De,{visible:h.visible,formData:h.formData,toggleVisible:function(){return P("edit")},reload:C}),t.createElement(Be,{visible:r.visible,formData:r.formData,loading:r.loading,toggleVisible:function(){return P("auth")},reload:C}))}}}]);
