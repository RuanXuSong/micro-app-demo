(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[67],{81186:function(U){U.exports={container:"container___rQUpQ",content:"content___EfHLm",title:"title___2UjJD",infoWrap:"infoWrap___1m2u0",avatarWrap:"avatarWrap___1D0Gv",submitWrap:"submitWrap___31jW9",editBtn:"editBtn___wf9nY"}},84850:function(U,E,r){"use strict";r.d(E,{Z:function(){return p}});var g=r(44742),f=r(67294);function p(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,P=(0,f.useState)(!1),A=(0,g.Z)(P,2),y=A[0],F=A[1],d=(0,f.useState)(""),s=(0,g.Z)(d,2),o=s[0],a=s[1];return(0,f.useEffect)(function(){F(Z)},[]),{spinning:y,setSpinning:F,tip:o,setTip:a}}},29067:function(U,E,r){"use strict";r.r(E),r.d(E,{default:function(){return i}});var g=r(58210),f=r(87240),p=r(13378),Z=r(83557),P=r(80148),A=r(13753),y=r(48429),F=r(67604),d=r(66498),s=r(68137),o=r(50532),a=r(67294),W=r(81186),h=r.n(W),b=r(12049),j=r(48786),ue=r(66594),ce=r(26780),ie=r(46567),$=r(14643),x=r(92909),z=r(3911),I=r(56361),N=r(44742),Y=r(46368),J=r(66827),R=r(84850),_=r(42348),k={labelCol:{span:6},wrapperCol:{span:18}},q=function(e){var t=e.visible,n=e.toggleVisible,u=e.formData,c=e.loading,m=d.Z.useForm(),v=(0,N.Z)(m,1),l=v[0],C=(0,R.Z)(),M=C.tip,H=C.setTip,K=(0,a.useState)(),X=(0,N.Z)(K,2),G=X[0],Q=X[1];(0,a.useEffect)(function(){if(!(0,Y.Z)(u)){var S=u.roleList||[];l.setFieldsValue((0,I.Z)((0,I.Z)({},u),{},{roleList:S.length>0?S[0].roleId:null}))}return function(){l.resetFields()}},[u]);var ee=function(){n(),l.resetFields()},te=function(w){H("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var de=w.confirmPassword,re=(0,z.Z)(w,["confirmPassword"]);return API.platform.sysUser.updatePassword.fetch(re)},D=(0,J.QT)(te,{manual:!0,onSuccess:function(){x.default.success("\u4FEE\u6539\u6210\u529F"),l.resetFields(),n()}}),ne=D.run,O=D.loading;return a.createElement(ie.Z,{centered:!0,visible:t,forceRender:!0,maskClosable:!1,title:"\u5BC6\u7801\u4FEE\u6539",okButtonProps:{htmlType:"submit"},width:422,onOk:function(){return l.submit()},onCancel:ee,confirmLoading:O},a.createElement(f.Z,{spinning:c&&O,tip:M},a.createElement(d.Z,(0,p.Z)({form:l,onFinish:ne},k),a.createElement(d.Z.Item,{label:"\u65E7\u5BC6\u7801",name:"oldPwd",rules:[{whitespace:!0},{required:!0}]},a.createElement(o.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165"})),a.createElement(d.Z.Item,{label:"\u65B0\u5BC6\u7801",name:"newPwd",rules:[{whitespace:!0},{required:!0}]},a.createElement(o.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165",onChange:function(w){return Q(w.target.value)}})),a.createElement(d.Z.Item,{label:"\u786E\u8BA4\u65B0\u5BC6\u7801",name:"confirmPassword",rules:[{whitespace:!0},{required:!0},{validator:(0,_.ZG)(G)}]},a.createElement(o.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165"})))))},V=r(89193),oe=function(e){var t=e.currentUser,n=e.dispatch,u=d.Z.useForm(),c=(0,N.Z)(u,1),m=c[0],v=(0,V.x)({visible:!1,formData:{},loading:!1}),l=(0,N.Z)(v,2),C=l[0],M=l[1],H=(0,V.x)({visible:!1,formData:{},loading:!1}),K=(0,N.Z)(H,2),X=K[0],G=K[1],Q=(0,R.Z)(),ee=Q.tip,te=Q.setTip,D=function(){return n({type:"user/fetchCurrent"})};(0,a.useEffect)(function(){var B=t.avatar,T=(0,z.Z)(t,["avatar"]);m.setFieldsValue((0,I.Z)((0,I.Z)({},T),{},{avatar:B?[{uid:"1",name:"\u5934\u50CF",status:"done",url:B,size:0}]:[]}))},[]);var ne=function(T){te("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var ae=(0,I.Z)((0,I.Z)({},T),{},{avatar:T.avatar.map(function(L){return L.url||L.response.data.url})[0]});return API.platform.sysUser.update.fetch(ae)},O=(0,J.QT)(ne,{manual:!0,onSuccess:function(){x.default.success("\u4FDD\u5B58\u6210\u529F"),D==null||D()}}),S=O.run,w=O.loading,de=function(){M(function(T){T.visible=!0,T.formData={id:m.getFieldValue("id")}})},re=function(T){var ae={edit:M,auth:G};ae[T](function(L){L.visible=!1,L.loading=!1,L.formData={}})};return{tip:ee,form:m,submitting:w,handleFinish:S,editModalConfig:C,setEditModalConfig:M,authModalConfig:X,setAuthModalConfig:G,handlePasswordEdit:de,handleModalHide:re}},se={labelCol:{span:4},wrapperCol:{span:18}},le=function(t){var n=oe(t),u=n.form,c=n.tip,m=n.submitting,v=n.handleFinish,l=n.editModalConfig,C=n.handlePasswordEdit,M=n.handleModalHide;return a.createElement("div",{className:h().container},a.createElement("div",{className:h().content},a.createElement(f.Z,{spinning:m,tip:c},a.createElement(d.Z,(0,p.Z)({form:u},se,{onFinish:v}),a.createElement("div",{className:h().title},"\u4E2A\u4EBA\u8D44\u6599"),a.createElement("div",{className:h().infoWrap},a.createElement("div",{className:h().avatarWrap},a.createElement(d.Z.Item,{label:"id",name:"id",hidden:!0,rules:[{whitespace:!0}]},a.createElement(o.Z,{placeholder:"\u8BF7\u8F93\u5165"})),a.createElement(d.Z.Item,{label:"\u5934\u50CF",name:"avatar"},a.createElement(P.Z,{maxCount:1,accept:b.b1.\u56FE\u7247.join(","),multiple:!1,listType:"picture-card",defaultFileList:[{uid:"1",name:"\u9ED8\u8BA4\u5934\u50CF",status:"done",response:"\u7F51\u7EDC\u8BF7\u6C42\u5931\u8D25",url:ue.q$}],showUploadList:{showRemoveIcon:!1}},a.createElement(y.Z,{type:"primary"},"\u66F4\u6362")))),a.createElement(d.Z.Item,{label:"\u8D26\u53F7\u540D\u79F0",name:"userName",rules:[{whitespace:!0}]},a.createElement(o.Z,{placeholder:"\u8BF7\u8F93\u5165"})),a.createElement(d.Z.Item,{label:"\u8D26\u53F7\u5BC6\u7801",name:"password",rules:[{whitespace:!0}]},a.createElement(y.Z,{className:h().editBtn,type:"link",onClick:C},"\u4FEE\u6539\u5BC6\u7801")),a.createElement("div",{className:h().submitWrap},a.createElement(y.Z,{type:"primary",htmlType:"submit",className:h().submitBtn},"\u4FDD\u5B58")))))),a.createElement(q,{visible:l.visible,formData:l.formData,loading:l.loading,toggleVisible:function(){return M("edit")}}))},i=(0,j.$j)(function(e){var t=e.user;return{currentUser:t.currentUser}})(le)},4137:function(U,E,r){"use strict";r.d(E,{Mn:function(){return g},Jh:function(){return p}});var g=function(s){var o=/^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|19[0-9]|14[57])[0-9]{8}$/;return o.test(s)},f=function(s){var o=/^([0-9]{3,4}-)?[0-9]{7,8}$/;return o.test(s)},p=function(s){var o=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;return o.test(s)},Z=function(s){var o=/(^([0-9]{1,})(.[0-9]+)?)$/;return o.test(s)},P=function(s){var o=/\d/;return o.test(s)},A=function(s){return(""+s).substring(1,(""+s).length-1)},y=function(s){var o=/^(-|\+)?\d+(\.\d+)?$/;return o.test(""+s)},F={isPhone:g,isTelephone:f,isEmail:p,isNumber:Z,containNumbers:P}},12049:function(U,E,r){"use strict";r.d(E,{S4:function(){return h},mf:function(){return j},b1:function(){return $},o$:function(){return R},jB:function(){return V},Ix:function(){return N},vE:function(){return Y}});var g=r(99463),f=1,p=1,Z=4,P={fillZero:function(e){return typeof e=="number"&&e>=10?e:"0".concat(e)},textEllipsis:function(e,t){return e.length>t&&t>0?"".concat(e.substring(0,t),"..."):e},getLastSubstring:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.substring(e.lastIndexOf(t)+t.length,e.length)},valueToString:function(e){return typeof e=="string"?e:JSON.stringify(e)},copyText:function(e){var t=document.createElement("input");document.body.appendChild(t),t.setAttribute("value",e),t.select(),document.execCommand("copy"),document.body.removeChild(t)},imgUrlToBase64:function(e,t,n){var u=document.createElement("canvas"),c=u.getContext("2d");return new Promise(function(m,v){var l=new Image;l.crossOrigin="Anonymous",l.onload=function(){u.width=t,u.height=n,c.drawImage(l,0,0,t,n);var C=u.toDataURL("image/");u=null,m(C)},l.onerror=function(C){v(C)},l.src=e})}},A=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return e||e===0?(e/100).toFixed(t):""},y=function(e){return e*100},F=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return e?"".concat(e.slice(0,t),"****").concat(e.slice(-t)):""},d=function(e){var t=/(?<=.)./g;return e==null?void 0:e.replace(t,"*")},s=function(e){var t,n=(t=e==null?void 0:e.split("-"))!==null&&t!==void 0?t:[];return n.filter(function(u){return!!u}).length===2?e:n.join("")},o=function(e,t){return e===f&&(t===p||t===Z)},a="http://object-service.dev.thundersdata.com",W=Object.freeze({maxSize:_,accept:k,maxCount:q}),h=10,b=1024,j=50*b,ue=500*b,ce=200,ie=200,$={\u56FE\u7247:[".jpg",".jpeg",".gif",".png",".bmp"],\u538B\u7F29\u5305:[".rar",".zip"],\u6587\u6863:[".doc",".docx",".pdf"],\u8868\u683C:[".xls",".xlsx"],\u89C6\u9891:[".avi",".wmv",".mpg",".mpeg",".mov",".mp4",".rm",".ram"]},x=function(e){var t=/^[0-9]+$/;return t.test(""+e)?"".concat(a,"/file/download?fileId=").concat(e,"&access_token=").concat(localStorage.getItem("accessToken")):"".concat(a,"/download/direct?fileId=").concat(e,"&access_token=").concat(localStorage.getItem("accessToken"))},z=function(e){var t,n,u;e.url?u=e.url:(t=e.response)!==null&&t!==void 0&&(n=t.data)!==null&&n!==void 0&&n.fileId&&(u=x(e.response.data.fileId)),u&&window.open(u,"_blank")},I=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$.\u56FE\u7247,n=e.name,u=e.url,c=u||n,m="."+P.getLastSubstring(c,"."),v=Array.isArray(t)?t:t.split(",");return v.includes(m)},N=function(){return{accept:".doc,.docx,.pdf,.rar,.zip,.jpg,.png,.bmp,.gif",withCredentials:!1,action:"".concat(a,"/file/uploadToPub"),data:{access_token:"223bc111017d323b00fee4cf9c59a2be"},showUploadList:{showDownloadIcon:!1},onPreview:z}},Y=function(e){var t=e.fileList;return t};function J(i,e,t){try{e&&e.some(function(n){if(n.response&&!n.response.success)throw new Error("\u4E0A\u4F20\u6587\u4EF6\u5931\u8D25: "+n.response.message);return n}),t()}catch(n){t(n)}}var R=function i(e){return typeof e=="number"?e>b?"".concat(e/1024," M"):"".concat(e," KB"):e?i(j):""};function _(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{maxSize:j},e=i.maxSize;return{validator:function(n,u,c){if(u&&u.length){var m=u.filter(function(l){return(l==null?void 0:l.size)&&l.size/b>e});if(m.length){var v=m.map(function(l){return l.name}).join(",");c("".concat(v,"\uFF0C\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7").concat(e>b?"".concat(e/1024," M"):"".concat(e," KB")))}else c()}else c()}}}function k(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{accept:$.\u56FE\u7247},e=i.accept;return{validator:function(n,u,c){if(u&&u.length){var m=u.filter(function(l){return!I(l,e)});if(m.length){var v=m.map(function(l){return'"'.concat(l.name,'"')}).join(",");c("\u6587\u4EF6\uFF1A".concat(v,"\uFF0C\u6587\u4EF6\u7C7B\u578B\u4E0D\u7B26\u5408\u8981\u6C42"))}else c()}else c()}}}function q(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{maxCount:h},e=i.maxCount;return{validator:function(n,u,c){u&&u.length&&u.length>e?c("\u6587\u4EF6\u4E2A\u6570\u8D85\u8FC7 ".concat(e," \u4E2A!")):c()}}}var V=function(e){var t=Object.keys(e).filter(function(n){return!!e[n]});return t.map(function(n){return e[n]===!0?W[n]():W[n]((0,g.Z)({},n,e[n]))})};function oe(i){return i&&i.length>0?i.map(function(e){var t=e.fileId,n=e.fileName,u=e.fileUrl,c=_objectWithoutProperties(e,["fileId","fileName","fileUrl"]);return _objectSpread(_objectSpread({},c),{},{uid:t,status:"done",size:0,type:"",name:n||x(t),url:u,response:{success:!0,data:{fileId:t,fileName:n||x(t),url:u}}})}):[]}function se(i){return i&&i.length>0?i.map(function(e){var t=e.response.data,n=t.fileId,u=t.fileName,c=t.url;return{fileId:n,fileName:u,fileUrl:c,type:""}}):[]}var le=function(e){return"".concat(a,"/file/preview?fileId=").concat(e)}},42348:function(U,E,r){"use strict";r.d(E,{tH:function(){return f},Le:function(){return p},ZG:function(){return A}});var g=r(4137),f=function(d,s,o){s&&!(0,g.Mn)(s)?o("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u7535\u8BDD\u53F7\u7801"):o()},p=function(d,s,o){s&&!(0,g.Jh)(s)?o("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u90AE\u7BB1"):o()},Z=function(d,s,o){s&&!/^(?=.*[a-zA-Z\W_])(?=.*[0-9]).{8,20}$/.test(s)?o("\u75318-20\u4E2A\u6570\u5B57+\u5B57\u6BCD\u6216\u7B26\u53F7\u7EC4\u6210\uFF0C\u4E0D\u53EF\u7EAF\u6570\u5B57"):o()},P=function(d,s,o){s&&!/^[\u4e00-\u9fa5a-zA-Z]{2,20}$/.test(s)?o("\u75312-20\u4E2A\u4E2D\u6587\u6216\u82F1\u6587\u7EC4\u6210"):o()},A=function(d){return function(s,o,a){o&&o!==d?a("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4"):a()}},y={phoneValidator:f,checkPassword:Z,checkNickName:P}}}]);
