(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[335],{34950:function(U,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0});var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};A.default=e},3855:function(U,A,e){"use strict";var _,V=e(95318),ee=e(20862);_={value:!0},A.Z=void 0;var C=ee(e(67294)),N=V(e(34950)),Q=V(e(92074)),S=function(t,Y){return C.createElement(Q.default,Object.assign({},t,{ref:Y,icon:N.default}))};S.displayName="ExclamationCircleOutlined";var X=C.forwardRef(S);A.Z=X},78863:function(U){U.exports={formWrap:"formWrap___3eS8c",rowWrap:"rowWrap___3VEOz",description:"description___bi6uK"}},79920:function(U){U.exports={formWrap:"formWrap___19ekr",rowWrap:"rowWrap___1jzhp",description:"description___2a_68"}},24342:function(U,A,e){"use strict";var _=e(13378),V=e(56361),ee=e(3911),C=e(67294),N=e(87542);A.Z=function(Q){var S=Q.value,X=S===void 0?[]:S,T=Q.onChange,t=(0,ee.Z)(Q,["value","onChange"]),Y={selectedRowKeys:X,onChange:function(ae){T==null||T(ae)}};return C.createElement(N.ZP,(0,_.Z)({rowSelection:(0,V.Z)((0,V.Z)({},Y),{},{checkStrictly:!0})},t))}},34335:function(U,A,e){"use strict";e.r(A),e.d(A,{default:function(){return Ke}});var _=e(13753),V=e(48429),ee=e(14643),C=e(92909),N=e(68699),Q=e(26780),S=e(46567),X=e(94043),T=e.n(X),t=e(67294),Y=e(87542),Z=e(66594),ae=e(49101),oe=e(96689),ge=e(31567),He=e(58210),ue=e(87240),ne=e(13378),Ge=e(97140),Ee=e(93228),Je=e(74393),ye=e(88995),Xe=e(68137),W=e(50532),Ye=e(68059),ie=e(84737),B=e(56361),ke=e(67604),c=e(66498),te=e(44742),Ce=e(47376),D=e(66827),se=e(84850),Ze=e(3678),Fe=e(95951),Ie=e(32615),Ae=e(3855),Se=e(79920),k=e.n(Se),de=e(42348),De=e(35510),be=e.n(De),Re=e(56051),ce=e.n(Re),le=e(27870),Oe=e(48786),Me=function(s){return s&&s<ce()().endOf("day")},me={labelCol:{span:8},wrapperCol:{span:14}},Te={labelCol:{span:4},wrapperCol:{span:19}},Be=function(a){var s=a.visible,F=a.toggleVisible,m=a.formData,h=a.reload,P=c.Z.useForm(),x=(0,te.Z)(P,1),p=x[0],d=(0,se.Z)(),L=d.tip,o=d.setTip,f=m.id,$=(0,Oe.tT)("company"),b=$.reloadCompanyData,g=(0,D.QT)(API.platform.sysOrg.detail.fetch,{onSuccess:function(r){p.setFieldsValue((0,B.Z)((0,B.Z)({},r),{},{validBefore:r.validBefore?ce()(r.validBefore):null,logo:r!=null&&r.logo?[{uid:"1",name:"logo",status:"done",url:r==null?void 0:r.logo,size:0}]:[]}))},manual:!0}),u=g.run,I=g.loading;(0,t.useEffect)(function(){return s&&f&&u({id:f}),function(){p.resetFields()}},[f,s]);var R=function(){F(),p.resetFields()},z=function(){p.resetFields(),F(),h==null||h(),b()},K=(0,D.QT)(API.platform.sysOrg.update.fetch,{onSuccess:function(){z(),C.default.success("\u4FDD\u5B58\u6210\u529F")},manual:!0}),O=K.run,w=K.loading,v=(0,D.QT)(API.platform.sysOrg.save.fetch,{onSuccess:function(r){z(),r&&ie.default.success({message:"\u79DF\u6237\u65B0\u5EFA\u6210\u529F",description:"\u5BC6\u7801\u4E3A: ".concat(r),duration:null})},manual:!0}),i=v.run,n=v.loading,E=function(r){o("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var G=(0,le.HO)((0,B.Z)((0,B.Z)((0,B.Z)({},m),r),{},{logo:r.logo.map(function(J){return J.url||J.response.data.url})[0]}));return f?O(G):i(G)},j=(0,D.QT)(E,{manual:!0}),H=j.run,y=j.loading,M=I||y||w||n;return t.createElement(S.Z,{centered:!0,visible:s,forceRender:!0,maskClosable:!1,title:"".concat((0,Ce.Z)(f)?"\u65B0\u5EFA":"\u7F16\u8F91","\u4F01\u4E1A"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return p.submit()},onCancel:R,confirmLoading:M},t.createElement(ue.Z,{spinning:M,tip:L},t.createElement(c.Z,(0,ne.Z)({form:p,onFinish:H},me,{className:k().formWrap}),t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"orgCode",tooltip:{icon:t.createElement(Ae.Z,null),title:`\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00
\u9700\u8981\u8F93\u516520\u4F4D\u4EE5\u5185\u5B57\u6BCD\uFF0C\u533A\u5206\u5927\u5C0F\u5199`},rules:[{whitespace:!0},{required:!0},{validator:de.T0}]},t.createElement(W.Z,{disabled:!!f,placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u540D\u79F0",name:"orgName",rules:[{whitespace:!0},{required:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:k().rowWrap},t.createElement(Ze.Z,{formItemProps:me,label:"\u4F01\u4E1Alogo",name:"logo",maxCount:1,accept:Fe.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20"},t.createElement(Ie.Z,null))),t.createElement("div",{className:k().rowWrap},t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u4EE3\u7801",name:"enterpriseCode",rules:[{whitespace:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement(c.Z.Item,{label:"\u8D1F\u8D23\u4EBA",name:"director",rules:[{whitespace:!0},{required:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{required:!0},{validator:de.tH}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),!!f&&t.createElement(c.Z.Item,{label:"\u7BA1\u7406\u5458\u8D26\u53F7",name:"directorUsername",rules:[{whitespace:!0}]},t.createElement(W.Z,{disabled:!0,placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u6709\u6548\u671F",name:"validBefore",rules:[{required:!0}]},t.createElement(ye.Z,{disabledDate:Me})),!!f&&t.createElement(t.Fragment,null,t.createElement(c.Z.Item,{label:"\u72B6\u6001",name:"status",rules:[{required:!0}]},t.createElement(Ee.Z,{options:(0,oe.MM)(Z.w6),placeholder:"\u8BF7\u9009\u62E9"})),t.createElement(c.Z.Item,{label:"\u5F53\u524D\u7528\u6237\u6570",name:"userNum"},t.createElement(W.Z,{disabled:!0,placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement("div",{className:be()(k().rowWrap,k().description)},t.createElement(c.Z.Item,(0,ne.Z)({label:"\u63CF\u8FF0",name:"description",rules:[{whitespace:!0},{required:!0}]},Te),t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"}))))))},Pe=e(3911),re=e(46368),xe=e(78863),Le=e.n(xe),We=e(96486),ze=e(24342),je=e(95760),Ue={labelCol:{span:6},wrapperCol:{span:16}},Ve=function(a){var s=a.visible,F=a.toggleVisible,m=a.formData,h=a.loading,P=a.reload,x=c.Z.useForm(),p=(0,te.Z)(x,1),d=p[0],L=(0,se.Z)(),o=L.tip,f=L.setTip,$=m.id,b=m.directorRoleId,g=m.orgCode,u=(0,D.QT)(API.platform.sysUser.myResourceList.fetch,{manual:!0}),I=u.run,R=u.data,z=u.loading;(0,t.useEffect)(function(){s&&g&&I({orgCode:g})},[s,g]);var K=(0,t.useMemo)(function(){return(0,je.r)(R)},[R]),O=(0,D.QT)(function(y){return API.platform.sysOrg.resourceList.fetch({id:y})},{manual:!0,onSuccess:function(M){var l=[],r=function G(J){J.forEach(function(q){var Ne=q.id,ve=q.privilegeList,he=ve===void 0?[]:ve,pe=q.children;l.push(Ne),(0,re.Z)(he)||he.forEach(function(Qe){l.push(Qe.id)}),(0,re.Z)(pe)||G(pe)})};r(M),d.setFieldsValue({resourceIds:l})}}),w=O.run;(0,t.useEffect)(function(){s&&w($)},[s]),(0,t.useEffect)(function(){return(0,re.Z)(m)||d.setFieldsValue(m),function(){d.resetFields()}},[m]);var v=function(){F(),d.resetFields()},i=function(M){var l=M.resourceIds,r=l===void 0?[]:l,G=(0,Pe.Z)(M,["resourceIds"]);f("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var J=(0,le.HO)((0,B.Z)((0,B.Z)({},G),{},{clientKey:Z.OW.clientId,id:b,resourceIds:r.filter(function(q){return(0,We.isNumber)(q)})}));return API.platform.sysRole.resourceSave.fetch(J)},n=(0,D.QT)(i,{manual:!0,onSuccess:function(){C.default.success("\u4FDD\u5B58\u6210\u529F"),d.resetFields(),F(),P==null||P()}}),E=n.run,j=n.loading,H=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"description",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u6807\u8BC6",dataIndex:"resourceKey",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"type",align:"left",copyable:!1,valueType:"text",render:function(M){return M===Z.o4.\u8DEF\u7531\u7EA7\u8D44\u6E90?"\u8DEF\u7531\u7EA7\u8D44\u6E90":"\u9875\u9762\u7EA7\u8D44\u6E90"}}];return t.createElement(S.Z,{centered:!0,visible:s,forceRender:!0,maskClosable:!1,title:"\u4F01\u4E1A\u6388\u6743",okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return d.submit()},onCancel:v,confirmLoading:j},t.createElement(ue.Z,{spinning:z||h&&j,tip:o},t.createElement(c.Z,(0,ne.Z)({form:d,onFinish:E},Ue,{className:Le().formWrap}),t.createElement(c.Z.Item,{label:"\u6743\u9650\u5217\u8868",name:"resourceIds",noStyle:!0},t.createElement(ze.Z,{search:!1,rowKey:"id",columns:H,dataSource:K})))))},fe=e(89193),$e=function(){var a=(0,t.useRef)(),s=(0,fe.x)({visible:!1,formData:{},loading:!1}),F=(0,te.Z)(s,2),m=F[0],h=F[1],P=(0,fe.x)({visible:!1,formData:{},loading:!1}),x=(0,te.Z)(P,2),p=x[0],d=x[1],L=a.current||{},o=L.reload,f=(0,D.QT)(API.platform.sysOrg.resetPassword.fetch,{manual:!0,onSuccess:function(i){C.default.success("\u91CD\u7F6E\u6210\u529F"),o==null||o(),i&&ie.default.success({message:"\u5BC6\u7801\u91CD\u7F6E\u6210\u529F",description:"\u5BC6\u7801\u4E3A: ".concat(i),duration:null})}}),$=f.run,b=(0,D.QT)(API.platform.sysOrg.updateStatus.fetch,{manual:!0,onSuccess:function(){C.default.success("\u64CD\u4F5C\u6210\u529F"),o==null||o()}}),g=b.run,u=(0,D.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){C.default.success("\u5220\u9664\u6210\u529F"),o==null||o()}}),I=u.run,R=function(){var v=(0,N.Z)(T().mark(function i(n){var E,j,H,y;return T().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,API.platform.sysOrg.pageList.fetch((0,le.HO)((0,B.Z)((0,B.Z)({},n),{},{page:(n==null?void 0:n.current)||Z.ii.page,pageSize:(n==null?void 0:n.pageSize)||Z.ii.pageSize})));case 2:return E=l.sent,j=E.list,H=E.page,y=E.total,l.abrupt("return",{data:j||[],page:H,success:!0,total:y});case 7:case"end":return l.stop()}},i)}));return function(n){return v.apply(this,arguments)}}(),z=function(i){h(function(n){n.visible=!0,n.loading=!0,n.formData=i})},K=function(){h(function(i){i.visible=!0,i.formData={}})},O=function(i){d(function(n){n.visible=!0,n.loading=!0,n.formData=i})},w=function(i){var n={edit:h,auth:d};n[i](function(E){E.visible=!1,E.loading=!1,E.formData={}})};return{actionRef:a,reload:o,editModalConfig:m,setEditModalConfig:h,authModalConfig:p,setAuthModalConfig:d,handleDelete:I,fetchList:R,handleCompanyEdit:z,handleUpdateStatus:g,handleResetPassword:$,handleCompanyAdd:K,handleAuthorize:O,handleModalHide:w}},Ke=function(){var a=$e(),s=a.actionRef,F=a.reload,m=a.editModalConfig,h=a.fetchList,P=a.handleResetPassword,x=a.handleUpdateStatus,p=a.handleCompanyAdd,d=a.handleCompanyEdit,L=a.handleModalHide,o=a.authModalConfig,f=a.handleAuthorize,$=[{title:"\u4F01\u4E1A\u7F16\u7801",dataIndex:"orgCode",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA",dataIndex:"director",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,oe.BJ)(Z.w6)},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"date",hideInSearch:!1,hideInTable:!0},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"date",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(g,u){return t.createElement(ge.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return d(u)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return f(u)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return S.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return u.id&&x({status:Z.w6.\u7981\u7528,id:"".concat(u.id)})}})},hidden:Z.w6.\u7981\u7528===+u.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var I=(0,N.Z)(T().mark(function z(){return T().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.abrupt("return",u.id&&x({status:Z.w6.\u6B63\u5E38,id:"".concat(u.id)}));case 1:case"end":return O.stop()}},z)}));function R(){return I.apply(this,arguments)}return R}(),hidden:Z.w6.\u7981\u7528!==+u.status},{name:"\u91CD\u7F6E\u5BC6\u7801",key:"reset",onClick:function(){return S.Z.confirm({title:"\u786E\u8BA4\u91CD\u7F6E\u5BC6\u7801\uFF1F",onOk:function(){return u.id&&P({id:"".concat(u.id)})}})}}]})}}];return t.createElement(t.Fragment,null,t.createElement(Y.ZP,{style:{padding:"18px 22px"},actionRef:s,request:h,onRequestError:function(g){console.error(g.message),C.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(g.message))},columns:$,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u4F01\u4E1A\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(V.Z,{onClick:p,key:"add",type:"primary"},t.createElement(ae.Z,null),"\u65B0\u5EFA")]}}),t.createElement(Be,{visible:m.visible,formData:m.formData,toggleVisible:function(){return L("edit")},reload:F}),t.createElement(Ve,{visible:o.visible,formData:o.formData,loading:o.loading,toggleVisible:function(){return L("auth")},reload:F}))}}}]);
