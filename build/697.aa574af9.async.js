(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[697],{34950:function(z,D){"use strict";Object.defineProperty(D,"__esModule",{value:!0});var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};D.default=e},3855:function(z,D,e){"use strict";var Y,j=e(95318),k=e(20862);Y={value:!0},D.Z=void 0;var x=k(e(67294)),H=j(e(34950)),w=j(e(92074)),L=function(t,Q){return x.createElement(w.default,Object.assign({},t,{ref:Q,icon:H.default}))};L.displayName="ExclamationCircleOutlined";var K=x.forwardRef(L);D.Z=K},78863:function(z){z.exports={formWrap:"formWrap___3eS8c",rowWrap:"rowWrap___3VEOz",description:"description___bi6uK"}},79920:function(z){z.exports={formWrap:"formWrap___19ekr",rowWrap:"rowWrap___1jzhp",description:"description___2a_68"}},97697:function(z,D,e){"use strict";e.r(D),e.d(D,{default:function(){return Te}});var Y=e(13753),j=e(48429),k=e(14643),x=e(92909),H=e(68699),w=e(26780),L=e(46567),K=e(94043),V=e.n(K),t=e(67294),Q=e(21191),A=e(66594),le=e(49101),oe=e(96689),re=e(31567),Oe=e(58210),q=e(87240),G=e(13378),Be=e(74393),ie=e(88995),ze=e(68137),P=e(50532),c=e(56361),Le=e(67604),m=e(66498),U=e(44742),J=e(46368),ue=e(47376),$=e(66827),_=e(84850),se=e(3678),de=e(12049),ce=e(32615),me=e(3855),fe=e(79920),N=e.n(fe),ve=e(42348),he=e(35510),pe=e.n(he),ge=e(56051),Ee=e.n(ge),ee={labelCol:{span:6},wrapperCol:{span:16}},ye={labelCol:{span:3},wrapperCol:{span:20}},Ce=function(a){var g=a.visible,i=a.toggleVisible,n=a.formData,f=a.loading,u=a.reload,I=m.Z.useForm(),E=(0,U.Z)(I,1),l=E[0],y=(0,_.Z)(),d=y.tip,B=y.setTip,v=n.id;(0,t.useEffect)(function(){return(0,J.Z)(n)||l.setFieldsValue((0,c.Z)((0,c.Z)({},n),{},{validBefore:Ee()(n.validBefore),logo:n!=null&&n.logo?[{uid:"1",name:"logo",status:"done",url:n==null?void 0:n.logo,size:0}]:[]})),function(){l.resetFields()}},[n]);var S=function(){i(),l.resetFields()},s=function(Z){B("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var h=(0,c.Z)((0,c.Z)((0,c.Z)({},n),Z),{},{logo:Z.logo.map(function(r){return r.url||r.response.data.url})[0]});return v?API.platform.sysOrg.update.fetch((0,c.Z)({},h)):API.platform.sysOrg.save.fetch(h)},C=(0,$.QT)(s,{manual:!0,onSuccess:function(){x.default.success("\u4FDD\u5B58\u6210\u529F"),l.resetFields(),i(),u==null||u()}}),R=C.run,M=C.loading;return t.createElement(L.Z,{centered:!0,visible:g,forceRender:!0,maskClosable:!1,title:"".concat((0,ue.Z)(v)?"\u65B0\u5EFA":"\u7F16\u8F91","\u4F01\u4E1A"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return l.submit()},onCancel:S,confirmLoading:M},t.createElement(q.Z,{spinning:f&&M,tip:d},t.createElement(m.Z,(0,G.Z)({form:l,onFinish:R},ee,{className:N().formWrap}),t.createElement(m.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"orgCode",tooltip:{icon:t.createElement(me.Z,null),title:"\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00"},rules:[{whitespace:!0},{required:!0}]},t.createElement(P.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(m.Z.Item,{label:"\u4F01\u4E1A\u540D\u79F0",name:"orgName",rules:[{whitespace:!0}]},t.createElement(P.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:N().rowWrap},t.createElement(se.Z,{formItemProps:ee,label:"\u4F01\u4E1Alogo",name:"logo",maxCount:1,accept:de.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20"},t.createElement(ce.Z,null))),t.createElement("div",{className:N().rowWrap},t.createElement(m.Z.Item,{label:"\u4F01\u4E1A\u4EE3\u7801",name:"enterpriseCode",rules:[{whitespace:!0}]},t.createElement(P.Z,{placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement(m.Z.Item,{label:"\u8D1F\u8D23\u4EBA",name:"director",rules:[{whitespace:!0}]},t.createElement(P.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(m.Z.Item,{label:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{validator:ve.tH}]},t.createElement(P.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(m.Z.Item,{label:"\u6709\u6548\u671F",name:"validBefore"},t.createElement(ie.Z,null)),t.createElement("div",{className:pe()(N().rowWrap,N().description)},t.createElement(m.Z.Item,(0,G.Z)({label:"\u63CF\u8FF0",name:"description",rules:[{whitespace:!0}]},ye),t.createElement(P.Z,{placeholder:"\u8BF7\u8F93\u5165"}))))))},Ze=e(78863),Fe=e.n(Ze),Pe=e(87753),Ie=e(98570),Ae=function(a){var g=a.value,i=a.onChange,n=a.treeData,f=n===void 0?[]:n,u=function(E){i==null||i(E)};return t.createElement(Ie.Z,{checkable:!0,onCheck:function(E){return u(E)},checkedKeys:g,treeData:f})},Se=e(48786),De={labelCol:{span:6},wrapperCol:{span:16}},xe=function(a){var g=a.visible,i=a.toggleVisible,n=a.formData,f=a.loading,u=a.reload,I=m.Z.useForm(),E=(0,U.Z)(I,1),l=E[0],y=(0,_.Z)(),d=y.tip,B=y.setTip,v=n.directorRoleId,S=(0,Se.tT)("@@initialState"),s=S.initialState,C=s||{},R=C.authResourceData,M=(0,$.QT)(function(p){return API.authorization.resource.listUserResourceData.fetch({clientKey:A.OW.clientId,roleId:p})},{manual:!0,onSuccess:function(W){var b=[];W.forEach(function(X){var O=X.id,ae=X.privilegeList,ne=ae===void 0?[]:ae;b.push(O),(0,J.Z)(ne)||ne.forEach(function(be){b.push(be.id)})}),l.setFieldsValue({resourceIds:b})}}),T=M.run;(0,t.useEffect)(function(){g&&T(v)},[g]),(0,t.useEffect)(function(){if(!(0,J.Z)(n)){var p=n.roleList||[];l.setFieldsValue((0,c.Z)((0,c.Z)({},n),{},{roleList:p.length>0?p[0].roleId:null}))}return function(){l.resetFields()}},[n]);var Z=function(){i(),l.resetFields()},h=function(W){B("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var b=(0,c.Z)((0,c.Z)({},W),{},{clientKey:A.OW.clientId,id:v});return API.authorization.resourceRole.resourceSave.fetch(b)},r=(0,$.QT)(h,{manual:!0,onSuccess:function(){x.default.success("\u4FDD\u5B58\u6210\u529F"),l.resetFields(),i(),u==null||u()}}),o=r.run,F=r.loading;return t.createElement(L.Z,{centered:!0,visible:g,forceRender:!0,maskClosable:!1,title:"\u4F01\u4E1A\u6388\u6743",okButtonProps:{htmlType:"submit"},width:412,onOk:function(){return l.submit()},onCancel:Z,confirmLoading:F},t.createElement(q.Z,{spinning:f&&F,tip:d},t.createElement(m.Z,(0,G.Z)({form:l,onFinish:o},De,{className:Fe().formWrap}),t.createElement(m.Z.Item,{label:"\u6743\u9650\u5217\u8868",name:"resourceIds",noStyle:!0},t.createElement(Ae,{treeData:R})))))},te=e(89193),Re=e(27870),Me=function(){var a=(0,t.useRef)(),g=(0,te.x)({visible:!1,formData:{},loading:!1}),i=(0,U.Z)(g,2),n=i[0],f=i[1],u=(0,te.x)({visible:!1,formData:{},loading:!1}),I=(0,U.Z)(u,2),E=I[0],l=I[1],y=a.current||{},d=y.reload,B=(0,$.QT)(API.platform.sysOrg.updateStatus.fetch,{manual:!0,onSuccess:function(){x.default.success("\u64CD\u4F5C\u6210\u529F"),d==null||d()}}),v=B.run,S=(0,$.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){x.default.success("\u5220\u9664\u6210\u529F"),d==null||d()}}),s=S.run,C=function(){var h=(0,H.Z)(V().mark(function r(o){var F,p,W,b;return V().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,API.platform.sysOrg.pageList.fetch((0,Re.HO)((0,c.Z)((0,c.Z)({},o),{},{page:(o==null?void 0:o.current)||A.ii.page,pageSize:(o==null?void 0:o.pageSize)||A.ii.pageSize})));case 2:return F=O.sent,p=F.list,W=F.page,b=F.total,O.abrupt("return",{data:p||[],page:W,success:!0,total:b});case 7:case"end":return O.stop()}},r)}));return function(o){return h.apply(this,arguments)}}(),R=function(r){f(function(o){o.visible=!0,o.loading=!0,o.formData=r})},M=function(){f(function(r){r.visible=!0,r.formData={}})},T=function(r){l(function(o){o.visible=!0,o.loading=!0,o.formData=r})},Z=function(r){var o={edit:f,auth:l};o[r](function(F){F.visible=!1,F.loading=!1,F.formData={}})};return{actionRef:a,reload:d,editModalConfig:n,setEditModalConfig:f,authModalConfig:E,setAuthModalConfig:l,handleDelete:s,fetchList:C,handleCompanyEdit:R,handleUpdateStatus:v,handleCompanyAdd:M,handleAuthorize:T,handleModalHide:Z}},Te=function(){var a=Me(),g=a.actionRef,i=a.reload,n=a.editModalConfig,f=a.fetchList,u=a.handleUpdateStatus,I=a.handleCompanyAdd,E=a.handleCompanyEdit,l=a.handleModalHide,y=a.authModalConfig,d=a.handleAuthorize,B=[{title:"\u4F01\u4E1A\u7F16\u7801",dataIndex:"orgCode",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA",dataIndex:"director",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,oe.BJ)(A.w6)},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"date",hideInSearch:!1,hideInTable:!0},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(S,s){return t.createElement(re.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return E(s)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return d(s)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return L.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return s.id&&u({status:A.w6.\u7981\u7528,id:"".concat(s.id)})}})},hidden:A.w6.\u7981\u7528===+s.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var C=(0,H.Z)(V().mark(function M(){return V().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",s.id&&u({status:A.w6.\u6B63\u5E38,id:"".concat(s.id)}));case 1:case"end":return Z.stop()}},M)}));function R(){return C.apply(this,arguments)}return R}(),hidden:A.w6.\u7981\u7528!==+s.status}]})}}];return t.createElement(t.Fragment,null,t.createElement(Q.ZP,{style:{padding:"18px 22px"},actionRef:g,request:f,onRequestError:function(S){console.error(S.message),x.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(S.message))},columns:B,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u4F01\u4E1A\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(j.Z,{onClick:I,key:"add",type:"primary"},t.createElement(le.Z,null),"\u65B0\u5EFA")]}}),t.createElement(Ce,{visible:n.visible,formData:n.formData,loading:n.loading,toggleVisible:function(){return l("edit")},reload:i}),t.createElement(xe,{visible:y.visible,formData:y.formData,loading:y.loading,toggleVisible:function(){return l("auth")},reload:i}))}}}]);
