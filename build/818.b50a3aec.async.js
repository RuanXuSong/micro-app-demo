(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[818],{34950:function(b,Z){"use strict";Object.defineProperty(Z,"__esModule",{value:!0});var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};Z.default=e},3855:function(b,Z,e){"use strict";var X,V=e(95318),G=e(20862);X={value:!0},Z.Z=void 0;var s=G(e(67294)),$=V(e(34950)),H=V(e(92074)),I=function(t,L){return s.createElement(H.default,Object.assign({},t,{ref:L,icon:$.default}))};I.displayName="ExclamationCircleOutlined";var K=s.forwardRef(I);Z.Z=K},78863:function(b){b.exports={formWrap:"formWrap___3eS8c",rowWrap:"rowWrap___3VEOz",description:"description___bi6uK"}},79920:function(b){b.exports={formWrap:"formWrap___19ekr",rowWrap:"rowWrap___1jzhp",description:"description___2a_68"}},57044:function(b,Z,e){"use strict";var X=e(87753),V=e(98570),G=e(67294);Z.Z=function(s){var $=s.value,H=s.onChange,I=s.treeData,K=I===void 0?[]:I,P=function(L){H==null||H(L)};return G.createElement(V.Z,{checkable:!0,defaultExpandAll:!0,onCheck:function(L){return P(L)},checkedKeys:$,treeData:K})}},39818:function(b,Z,e){"use strict";e.r(Z),e.d(Z,{default:function(){return Re}});var X=e(13753),V=e(48429),G=e(14643),s=e(92909),$=e(68699),H=e(26780),I=e(46567),K=e(94043),P=e.n(K),t=e(67294),L=e(21191),A=e(66594),re=e(49101),oe=e(96689),ie=e(31567),Te=e(58210),_=e(87240),Y=e(13378),Be=e(74393),ue=e(88995),be=e(68137),N=e(50532),d=e(56361),Pe=e(67604),c=e(66498),J=e(44742),k=e(46368),se=e(47376),j=e(66827),ee=e(84850),de=e(3678),ce=e(95951),me=e(32615),fe=e(3855),ve=e(79920),Q=e.n(ve),he=e(42348),pe=e(35510),ge=e.n(pe),Ee=e(56051),Ce=e.n(Ee),w=e(27870),te={labelCol:{span:8},wrapperCol:{span:14}},ye={labelCol:{span:4},wrapperCol:{span:19}},Ze=function(a){var D=a.visible,p=a.toggleVisible,n=a.formData,F=a.loading,m=a.reload,M=c.Z.useForm(),z=(0,J.Z)(M,1),l=z[0],g=(0,ee.Z)(),u=g.tip,W=g.setTip,f=n.id;(0,t.useEffect)(function(){return(0,k.Z)(n)||l.setFieldsValue((0,d.Z)((0,d.Z)({},n),{},{validBefore:n.validBefore?Ce()(n.validBefore):null,logo:n!=null&&n.logo?[{uid:"1",name:"logo",status:"done",url:n==null?void 0:n.logo,size:0}]:[]})),function(){l.resetFields()}},[n]);var S=function(){p(),l.resetFields()},i=function(C){W("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var v=(0,w.HO)((0,d.Z)((0,d.Z)((0,d.Z)({},n),C),{},{logo:C.logo.map(function(o){return o.url||o.response.data.url})[0]}));return f?API.platform.sysOrg.update.fetch((0,d.Z)({},v)):API.platform.sysOrg.save.fetch(v)},E=(0,j.QT)(i,{manual:!0,onSuccess:function(){s.default.success("\u4FDD\u5B58\u6210\u529F"),l.resetFields(),p(),m==null||m()}}),O=E.run,R=E.loading;return t.createElement(I.Z,{centered:!0,visible:D,forceRender:!0,maskClosable:!1,title:"".concat((0,se.Z)(f)?"\u65B0\u5EFA":"\u7F16\u8F91","\u4F01\u4E1A"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return l.submit()},onCancel:S,confirmLoading:R},t.createElement(_.Z,{spinning:F&&R,tip:u},t.createElement(c.Z,(0,Y.Z)({form:l,onFinish:O},te,{className:Q().formWrap}),t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"orgCode",tooltip:{icon:t.createElement(fe.Z,null),title:"\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00"},rules:[{whitespace:!0},{required:!0}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u540D\u79F0",name:"orgName",rules:[{whitespace:!0}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:Q().rowWrap},t.createElement(de.Z,{formItemProps:te,label:"\u4F01\u4E1Alogo",name:"logo",maxCount:1,accept:ce.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20"},t.createElement(me.Z,null))),t.createElement("div",{className:Q().rowWrap},t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u4EE3\u7801",name:"enterpriseCode",rules:[{whitespace:!0}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement(c.Z.Item,{label:"\u8D1F\u8D23\u4EBA",name:"director",rules:[{whitespace:!0}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{required:!0},{validator:he.tH}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u6709\u6548\u671F",name:"validBefore"},t.createElement(ue.Z,null)),t.createElement("div",{className:ge()(Q().rowWrap,Q().description)},t.createElement(c.Z.Item,(0,Y.Z)({label:"\u63CF\u8FF0",name:"description",rules:[{whitespace:!0}]},ye),t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"}))))))},Fe=e(78863),Ie=e.n(Fe),Ae=e(57044),De=e(48786),Se={labelCol:{span:6},wrapperCol:{span:16}},Me=function(a){var D=a.visible,p=a.toggleVisible,n=a.formData,F=a.loading,m=a.reload,M=c.Z.useForm(),z=(0,J.Z)(M,1),l=z[0],g=(0,ee.Z)(),u=g.tip,W=g.setTip,f=n.directorRoleId,S=(0,De.tT)("@@initialState"),i=S.initialState,E=i||{},O=E.authResourceData,R=(0,j.QT)(function(h){return API.authorization.resource.listUserResourceData.fetch({clientKey:A.OW.clientId,roleId:h})},{manual:!0,onSuccess:function(U){var T=[];U.forEach(function(q){var B=q.id,ne=q.privilegeList,le=ne===void 0?[]:ne;T.push(B),(0,k.Z)(le)||le.forEach(function(xe){T.push(xe.id)})}),l.setFieldsValue({resourceIds:T})}}),x=R.run;(0,t.useEffect)(function(){D&&x(f)},[D]),(0,t.useEffect)(function(){if(!(0,k.Z)(n)){var h=n.roleList||[];l.setFieldsValue((0,d.Z)((0,d.Z)({},n),{},{roleList:h.length>0?h[0].roleId:null}))}return function(){l.resetFields()}},[n]);var C=function(){p(),l.resetFields()},v=function(U){W("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var T=(0,w.HO)((0,d.Z)((0,d.Z)({},U),{},{clientKey:A.OW.clientId,id:f}));return API.authorization.resourceRole.resourceSave.fetch(T)},o=(0,j.QT)(v,{manual:!0,onSuccess:function(){s.default.success("\u4FDD\u5B58\u6210\u529F"),l.resetFields(),p(),m==null||m()}}),r=o.run,y=o.loading;return t.createElement(I.Z,{centered:!0,visible:D,forceRender:!0,maskClosable:!1,title:"\u4F01\u4E1A\u6388\u6743",okButtonProps:{htmlType:"submit"},width:412,onOk:function(){return l.submit()},onCancel:C,confirmLoading:y},t.createElement(_.Z,{spinning:F&&y,tip:u},t.createElement(c.Z,(0,Y.Z)({form:l,onFinish:r},Se,{className:Ie().formWrap}),t.createElement(c.Z.Item,{label:"\u6743\u9650\u5217\u8868",name:"resourceIds",noStyle:!0},t.createElement(Ae.Z,{treeData:O})))))},ae=e(89193),Oe=function(){var a=(0,t.useRef)(),D=(0,ae.x)({visible:!1,formData:{},loading:!1}),p=(0,J.Z)(D,2),n=p[0],F=p[1],m=(0,ae.x)({visible:!1,formData:{},loading:!1}),M=(0,J.Z)(m,2),z=M[0],l=M[1],g=a.current||{},u=g.reload,W=(0,j.QT)(API.platform.sysOrg.updateStatus.fetch,{manual:!0,onSuccess:function(){s.default.success("\u64CD\u4F5C\u6210\u529F"),u==null||u()}}),f=W.run,S=(0,j.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){s.default.success("\u5220\u9664\u6210\u529F"),u==null||u()}}),i=S.run,E=function(){var v=(0,$.Z)(P().mark(function o(r){var y,h,U,T;return P().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,API.platform.sysOrg.pageList.fetch((0,w.HO)((0,d.Z)((0,d.Z)({},r),{},{page:(r==null?void 0:r.current)||A.ii.page,pageSize:(r==null?void 0:r.pageSize)||A.ii.pageSize})));case 2:return y=B.sent,h=y.list,U=y.page,T=y.total,B.abrupt("return",{data:h||[],page:U,success:!0,total:T});case 7:case"end":return B.stop()}},o)}));return function(r){return v.apply(this,arguments)}}(),O=function(o){F(function(r){r.visible=!0,r.loading=!0,r.formData=o})},R=function(){F(function(o){o.visible=!0,o.formData={}})},x=function(o){l(function(r){r.visible=!0,r.loading=!0,r.formData=o})},C=function(o){var r={edit:F,auth:l};r[o](function(y){y.visible=!1,y.loading=!1,y.formData={}})};return{actionRef:a,reload:u,editModalConfig:n,setEditModalConfig:F,authModalConfig:z,setAuthModalConfig:l,handleDelete:i,fetchList:E,handleCompanyEdit:O,handleUpdateStatus:f,handleCompanyAdd:R,handleAuthorize:x,handleModalHide:C}},Re=function(){var a=Oe(),D=a.actionRef,p=a.reload,n=a.editModalConfig,F=a.fetchList,m=a.handleUpdateStatus,M=a.handleCompanyAdd,z=a.handleCompanyEdit,l=a.handleModalHide,g=a.authModalConfig,u=a.handleAuthorize,W=[{title:"\u4F01\u4E1A\u7F16\u7801",dataIndex:"orgCode",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA",dataIndex:"director",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,oe.BJ)(A.w6)},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"date",hideInSearch:!1,hideInTable:!0},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(S,i){return t.createElement(ie.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return z(i)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return u(i)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return I.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return i.id&&m({status:A.w6.\u7981\u7528,id:"".concat(i.id)})}})},hidden:A.w6.\u7981\u7528===+i.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var E=(0,$.Z)(P().mark(function R(){return P().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",i.id&&m({status:A.w6.\u6B63\u5E38,id:"".concat(i.id)}));case 1:case"end":return C.stop()}},R)}));function O(){return E.apply(this,arguments)}return O}(),hidden:A.w6.\u7981\u7528!==+i.status}]})}}];return t.createElement(t.Fragment,null,t.createElement(L.ZP,{style:{padding:"18px 22px"},actionRef:D,request:F,onRequestError:function(S){console.error(S.message),s.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(S.message))},columns:W,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u4F01\u4E1A\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(V.Z,{onClick:M,key:"add",type:"primary"},t.createElement(re.Z,null),"\u65B0\u5EFA")]}}),t.createElement(Ze,{visible:n.visible,formData:n.formData,loading:n.loading,toggleVisible:function(){return l("edit")},reload:p}),t.createElement(Me,{visible:g.visible,formData:g.formData,loading:g.loading,toggleVisible:function(){return l("auth")},reload:p}))}}}]);
