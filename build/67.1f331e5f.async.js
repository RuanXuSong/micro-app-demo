(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[67],{81186:function(L){L.exports={container:"container___rQUpQ",content:"content___EfHLm",title:"title___2UjJD",infoWrap:"infoWrap___1m2u0",avatarWrap:"avatarWrap___1D0Gv",submitWrap:"submitWrap___31jW9",editBtn:"editBtn___wf9nY"}},84850:function(L,E,r){"use strict";r.d(E,{Z:function(){return f}});var v=r(44742),m=r(67294);function f(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=(0,m.useState)(!1),g=(0,v.Z)(p,2),F=g[0],Z=g[1],o=(0,m.useState)(""),a=(0,v.Z)(o,2),e=a[0],t=a[1];return(0,m.useEffect)(function(){Z(T)},[]),{spinning:F,setSpinning:Z,tip:e,setTip:t}}},29067:function(L,E,r){"use strict";r.r(E),r.d(E,{default:function(){return pe}});var v=r(58210),m=r(87240),f=r(83557),T=r(80148),p=r(13378),g=r(13753),F=r(48429),Z=r(67604),o=r(66498),a=r(68137),e=r(50532),t=r(67294),b=r(81186),c=r.n(b),x=r(95951),X=r(48786),q=r(66594),M=r(26780),w=r(46567),ce=r(14643),ee=r(92909),G=r(3911),Q=r(56361),V=r(44742),me=r(46368),s=r(66827),n=r(84850),i=r(42348),u={labelCol:{span:6},wrapperCol:{span:18}},l=function(I){var N=I.visible,P=I.toggleVisible,U=I.formData,Y=I.loading,O=o.Z.useForm(),J=(0,V.Z)(O,1),h=J[0],R=(0,n.Z)(),j=R.tip,$=R.setTip,B=(0,t.useState)(),D=(0,V.Z)(B,2),te=D[0],ne=D[1];(0,t.useEffect)(function(){if(!(0,me.Z)(U)){var A=U.roleList||[];h.setFieldsValue((0,Q.Z)((0,Q.Z)({},U),{},{roleList:A.length>0?A[0].roleId:null}))}return function(){h.resetFields()}},[U]);var re=function(){P(),h.resetFields()},ae=function(H){$("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var fe=H.confirmPassword,ue=(0,G.Z)(H,["confirmPassword"]);return API.platform.sysUser.updatePassword.fetch(ue)},z=(0,s.QT)(ae,{manual:!0,onSuccess:function(){ee.default.success("\u4FEE\u6539\u6210\u529F"),h.resetFields(),P()}}),ie=z.run,k=z.loading;return t.createElement(w.Z,{centered:!0,visible:N,forceRender:!0,maskClosable:!1,title:"\u5BC6\u7801\u4FEE\u6539",okButtonProps:{htmlType:"submit"},width:422,onOk:function(){return h.submit()},onCancel:re,confirmLoading:k},t.createElement(m.Z,{spinning:Y&&k,tip:j},t.createElement(o.Z,(0,p.Z)({form:h,onFinish:ie},u),t.createElement(o.Z.Item,{label:"\u65E7\u5BC6\u7801",name:"oldPwd",rules:[{whitespace:!0},{required:!0}]},t.createElement(e.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(o.Z.Item,{label:"\u65B0\u5BC6\u7801",name:"newPwd",rules:[{whitespace:!0},{required:!0}]},t.createElement(e.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165",onChange:function(H){return ne(H.target.value)}})),t.createElement(o.Z.Item,{label:"\u786E\u8BA4\u65B0\u5BC6\u7801",name:"confirmPassword",rules:[{whitespace:!0},{required:!0},{validator:(0,i.ZG)(te)}]},t.createElement(e.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165"})))))},d=r(89193),y=function(I){var N=I.currentUser,P=I.dispatch,U=o.Z.useForm(),Y=(0,V.Z)(U,1),O=Y[0],J=(0,d.x)({visible:!1,formData:{},loading:!1}),h=(0,V.Z)(J,2),R=h[0],j=h[1],$=(0,d.x)({visible:!1,formData:{},loading:!1}),B=(0,V.Z)($,2),D=B[0],te=B[1],ne=(0,n.Z)(),re=ne.tip,ae=ne.setTip,z=function(){return P({type:"user/fetchCurrent"})};(0,t.useEffect)(function(){var W=N.avatar,S=(0,G.Z)(N,["avatar"]);O.setFieldsValue((0,Q.Z)((0,Q.Z)({},S),{},{avatar:W?[{uid:"1",name:"\u5934\u50CF",status:"done",url:W,size:0}]:[]}))},[]);var ie=function(S){ae("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var ve=S.avatar,K=(0,G.Z)(S,["avatar"]);if(S.avatar){var oe,se,le,de;K.avatar=(oe=S.avatar)===null||oe===void 0||(se=oe.file)===null||se===void 0||(le=se.response)===null||le===void 0||(de=le.data)===null||de===void 0?void 0:de.url}return API.platform.sysUser.update.fetch(K)},k=(0,s.QT)(ie,{manual:!0,onSuccess:function(){ee.default.success("\u4FDD\u5B58\u6210\u529F"),z==null||z()}}),A=k.run,H=k.loading,fe=function(){j(function(S){S.visible=!0,S.formData={id:O.getFieldValue("id")}})},ue=function(S){var ve={edit:j,auth:te};ve[S](function(K){K.visible=!1,K.loading=!1,K.formData={}})};return{tip:re,form:O,submitting:H,handleFinish:A,editModalConfig:R,setEditModalConfig:j,authModalConfig:D,setAuthModalConfig:te,handlePasswordEdit:fe,handleModalHide:ue}},_={labelCol:{span:4},wrapperCol:{span:18}},C=function(N){var P=y(N),U=P.form,Y=P.tip,O=P.submitting,J=P.handleFinish,h=P.editModalConfig,R=P.handlePasswordEdit,j=P.handleModalHide;return t.createElement("div",{className:c().container},t.createElement("div",{className:c().content},t.createElement(m.Z,{spinning:O,tip:Y},t.createElement(o.Z,(0,p.Z)({form:U},_,{onFinish:J}),t.createElement("div",{className:c().title},"\u4E2A\u4EBA\u8D44\u6599"),t.createElement("div",{className:c().infoWrap},t.createElement("div",{className:c().avatarWrap},t.createElement(o.Z.Item,{label:"id",name:"id",hidden:!0,rules:[{whitespace:!0}]},t.createElement(e.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(o.Z.Item,{label:"\u5934\u50CF",name:"avatar",valuePropName:"fileList",getValueFromEvent:x.vE,getValueProps:function(B){var D=B!=null?B:[];return{fileList:Array.isArray(D)?D:[{url:D}]}}},t.createElement(T.Z,(0,p.Z)({},(0,x.Ix)(),{maxCount:1,accept:x.b1.\u56FE\u7247.join(","),multiple:!1,listType:"picture-card",defaultFileList:[{uid:"1",name:"\u9ED8\u8BA4\u5934\u50CF",status:"done",response:"\u7F51\u7EDC\u8BF7\u6C42\u5931\u8D25",url:q.q$}],showUploadList:{showRemoveIcon:!1}}),t.createElement(F.Z,{type:"primary"},"\u66F4\u6362")))),t.createElement(o.Z.Item,{label:"\u8D26\u53F7\u540D\u79F0",name:"userName",rules:[{whitespace:!0}]},t.createElement(e.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(o.Z.Item,{label:"\u8D26\u53F7\u5BC6\u7801",name:"password",rules:[{whitespace:!0}]},t.createElement(F.Z,{className:c().editBtn,type:"link",onClick:R},"\u4FEE\u6539\u5BC6\u7801")),t.createElement("div",{className:c().submitWrap},t.createElement(F.Z,{type:"primary",htmlType:"submit",className:c().submitBtn},"\u4FDD\u5B58")))))),t.createElement(l,{visible:h.visible,formData:h.formData,loading:h.loading,toggleVisible:function(){return j("edit")}}))},pe=(0,X.$j)(function(I){var N=I.user;return{currentUser:N.currentUser}})(C)},4137:function(L,E,r){"use strict";r.d(E,{Mn:function(){return v},Jh:function(){return f}});var v=function(a){var e=/^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|19[0-9]|14[57])[0-9]{8}$/;return e.test(a)},m=function(a){var e=/^([0-9]{3,4}-)?[0-9]{7,8}$/;return e.test(a)},f=function(a){var e=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;return e.test(a)},T=function(a){var e=/(^([0-9]{1,})(.[0-9]+)?)$/;return e.test(a)},p=function(a){var e=/\d/;return e.test(a)},g=function(a){return(""+a).substring(1,(""+a).length-1)},F=function(a){var e=/^(-|\+)?\d+(\.\d+)?$/;return e.test(""+a)},Z={isPhone:v,isTelephone:m,isEmail:f,isNumber:T,containNumbers:p}},73567:function(L,E,r){"use strict";var v=1,m=1,f=4;E.ZP={fillZero:function(e){return typeof e=="number"&&e>=10?e:"0".concat(e)},textEllipsis:function(e,t){return e.length>t&&t>0?"".concat(e.substring(0,t),"..."):e},getLastSubstring:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.substring(e.lastIndexOf(t)+t.length,e.length)},valueToString:function(e){return typeof e=="string"?e:JSON.stringify(e)},copyText:function(e){var t=document.createElement("input");document.body.appendChild(t),t.setAttribute("value",e),t.select(),document.execCommand("copy"),document.body.removeChild(t)},imgUrlToBase64:function(e,t,b){var c=document.createElement("canvas"),x=c.getContext("2d");return new Promise(function(X,q){var M=new Image;M.crossOrigin="Anonymous",M.onload=function(){c.width=t,c.height=b,x.drawImage(M,0,0,t,b);var w=c.toDataURL("image/");c=null,X(w)},M.onerror=function(w){q(w)},M.src=e})}};var T=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return e||e===0?(e/100).toFixed(t):""},p=function(e){return e*100},g=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return e?"".concat(e.slice(0,t),"****").concat(e.slice(-t)):""},F=function(e){var t=/(?<=.)./g;return e==null?void 0:e.replace(t,"*")},Z=function(e){var t,b=(t=e==null?void 0:e.split("-"))!==null&&t!==void 0?t:[];return b.filter(function(c){return!!c}).length===2?e:b.join("")},o=function(e,t){return e===v&&(t===m||t===f)}},95951:function(L,E,r){"use strict";r.d(E,{S4:function(){return p},mf:function(){return F},b1:function(){return e},Ix:function(){return x},vE:function(){return X},o$:function(){return M},jB:function(){return G}});var v=r(99463),m=r(73567),f="http://object-service.dev.thundersdata.com",T=Object.freeze({maxSize:w,accept:ce,maxCount:ee}),p=10,g=1024,F=50*g,Z=500*g,o=200,a=200,e={\u56FE\u7247:[".jpg",".jpeg",".gif",".png",".bmp"],\u538B\u7F29\u5305:[".rar",".zip"],\u6587\u6863:[".doc",".docx",".pdf"],\u8868\u683C:[".xls",".xlsx"],\u89C6\u9891:[".avi",".wmv",".mpg",".mpeg",".mov",".mp4",".rm",".ram"]},t=function(n){var i=/^[0-9]+$/;return i.test(""+n)?"".concat(f,"/file/download?fileId=").concat(n,"&access_token=").concat(localStorage.getItem("accessToken")):"".concat(f,"/download/direct?fileId=").concat(n,"&access_token=").concat(localStorage.getItem("accessToken"))},b=function(n){var i,u,l;n.url?l=n.url:(i=n.response)!==null&&i!==void 0&&(u=i.data)!==null&&u!==void 0&&u.fileId&&(l=t(n.response.data.fileId)),l&&window.open(l,"_blank")},c=function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.\u56FE\u7247,u=n.name,l=n.url,d=l||u,y="."+m.ZP.getLastSubstring(d,"."),_=Array.isArray(i)?i:i.split(",");return _.includes(y)},x=function(){return{accept:".doc,.docx,.pdf,.rar,.zip,.jpg,.png,.bmp,.gif",withCredentials:!1,action:"".concat(f,"/file/uploadToPub"),data:{access_token:"223bc111017d323b00fee4cf9c59a2be"},showUploadList:{showDownloadIcon:!1},onPreview:b}},X=function(n){var i=n.fileList;return i};function q(s,n,i){try{n&&n.some(function(u){if(u.response&&!u.response.success)throw new Error("\u4E0A\u4F20\u6587\u4EF6\u5931\u8D25: "+u.response.message);return u}),i()}catch(u){i(u)}}var M=function s(n){return typeof n=="number"?n>g?"".concat(n/1024," M"):"".concat(n," KB"):n?s(F):""};function w(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{maxSize:F},n=s.maxSize;return{validator:function(u,l,d){if(l&&l.length){var y=l.filter(function(C){return(C==null?void 0:C.size)&&C.size/g>n});if(y.length){var _=y.map(function(C){return C.name}).join(",");d("".concat(_,"\uFF0C\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7").concat(n>g?"".concat(n/1024," M"):"".concat(n," KB")))}else d()}else d()}}}function ce(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{accept:e.\u56FE\u7247},n=s.accept;return{validator:function(u,l,d){if(l&&l.length){var y=l.filter(function(C){return!c(C,n)});if(y.length){var _=y.map(function(C){return'"'.concat(C.name,'"')}).join(",");d("\u6587\u4EF6\uFF1A".concat(_,"\uFF0C\u6587\u4EF6\u7C7B\u578B\u4E0D\u7B26\u5408\u8981\u6C42"))}else d()}else d()}}}function ee(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{maxCount:p},n=s.maxCount;return{validator:function(u,l,d){l&&l.length&&l.length>n?d("\u6587\u4EF6\u4E2A\u6570\u8D85\u8FC7 ".concat(n," \u4E2A!")):d()}}}var G=function(n){var i=Object.keys(n).filter(function(u){return!!n[u]});return i.map(function(u){return n[u]===!0?T[u]():T[u]((0,v.Z)({},u,n[u]))})};function Q(s){return s&&s.length>0?s.map(function(n){var i=n.fileId,u=n.fileName,l=n.fileUrl,d=_objectWithoutProperties(n,["fileId","fileName","fileUrl"]);return _objectSpread(_objectSpread({},d),{},{uid:i,status:"done",size:0,type:"",name:u||t(i),url:l,response:{success:!0,data:{fileId:i,fileName:u||t(i),url:l}}})}):[]}function V(s){return s&&s.length>0?s.map(function(n){var i=n.response.data,u=i.fileId,l=i.fileName,d=i.url;return{fileId:u,fileName:l,fileUrl:d,type:""}}):[]}var me=function(n){return"".concat(f,"/file/preview?fileId=").concat(n)}},42348:function(L,E,r){"use strict";r.d(E,{tH:function(){return m},Le:function(){return f},ZG:function(){return g}});var v=r(4137),m=function(o,a,e){a&&!(0,v.Mn)(a)?e("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u7535\u8BDD\u53F7\u7801"):e()},f=function(o,a,e){a&&!(0,v.Jh)(a)?e("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u90AE\u7BB1"):e()},T=function(o,a,e){a&&!/^(?=.*[a-zA-Z\W_])(?=.*[0-9]).{8,20}$/.test(a)?e("\u75318-20\u4E2A\u6570\u5B57+\u5B57\u6BCD\u6216\u7B26\u53F7\u7EC4\u6210\uFF0C\u4E0D\u53EF\u7EAF\u6570\u5B57"):e()},p=function(o,a,e){a&&!/^[\u4e00-\u9fa5a-zA-Z]{2,20}$/.test(a)?e("\u75312-20\u4E2A\u4E2D\u6587\u6216\u82F1\u6587\u7EC4\u6210"):e()},g=function(o){return function(a,e,t){e&&e!==o?t("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4"):t()}},F={phoneValidator:m,checkPassword:T,checkNickName:p}}}]);
