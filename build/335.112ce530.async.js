(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[335],{34950:function($,F){"use strict";Object.defineProperty(F,"__esModule",{value:!0});var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};F.default=e},3855:function($,F,e){"use strict";var k,H=e(95318),w=e(20862);k={value:!0},F.Z=void 0;var y=w(e(67294)),N=H(e(34950)),Q=H(e(92074)),I=function(t,X){return y.createElement(Q.default,Object.assign({},t,{ref:X,icon:N.default}))};I.displayName="ExclamationCircleOutlined";var J=y.forwardRef(I);F.Z=J},78863:function($){$.exports={formWrap:"formWrap___3eS8c",rowWrap:"rowWrap___3VEOz",description:"description___bi6uK"}},79920:function($){$.exports={formWrap:"formWrap___19ekr",rowWrap:"rowWrap___1jzhp",description:"description___2a_68"}},24342:function($,F,e){"use strict";var k=e(13378),H=e(56361),w=e(3911),y=e(67294),N=e(87542);F.Z=function(Q){var I=Q.value,J=I===void 0?[]:I,O=Q.onChange,t=(0,w.Z)(Q,["value","onChange"]),X={selectedRowKeys:J,onChange:function(ee){O==null||O(ee)}};return y.createElement(N.ZP,(0,k.Z)({rowSelection:(0,H.Z)((0,H.Z)({},X),{},{checkStrictly:!0})},t))}},34335:function($,F,e){"use strict";e.r(F),e.d(F,{default:function(){return ze}});var k=e(13753),H=e(48429),w=e(14643),y=e(92909),N=e(68699),Q=e(26780),I=e(46567),J=e(94043),O=e.n(J),t=e(67294),X=e(87542),h=e(66594),ee=e(49101),ne=e(96689),fe=e(31567),je=e(58210),le=e(87240),te=e(13378),Ue=e(97140),ve=e(93228),Ve=e(74393),he=e(88995),Ke=e(68137),W=e(50532),$e=e(68059),pe=e(84737),R=e(56361),He=e(67604),s=e(66498),q=e(44742),ge=e(47376),T=e(66827),re=e(84850),Ee=e(3678),ye=e(95951),Ce=e(32615),Ze=e(3855),Fe=e(79920),Y=e.n(Fe),_=e(42348),Ie=e(35510),Ae=e.n(Ie),Se=e(56051),oe=e.n(Se),ae=e(27870),ue=e(48786),be=function(m){return m&&m<oe()().endOf("day")},ie={labelCol:{span:8},wrapperCol:{span:14}},De={labelCol:{span:4},wrapperCol:{span:19}},Oe=function(n){var m=n.visible,C=n.toggleVisible,p=n.formData,g=n.reload,M=s.Z.useForm(),x=(0,q.Z)(M,1),E=x[0],u=(0,re.Z)(),B=u.tip,r=u.setTip,f=p.id,z=(0,ue.tT)("company"),A=z.reloadCompanyData,S=(0,T.QT)(API.platform.sysOrg.detail.fetch,{onSuccess:function(c){E.setFieldsValue((0,R.Z)((0,R.Z)({},c),{},{validBefore:c.validBefore?oe()(c.validBefore):null,logo:c!=null&&c.logo?[{uid:"1",name:"logo",status:"done",url:c==null?void 0:c.logo,size:0}]:[]}))},manual:!0}),i=S.run,Z=S.loading;(0,t.useEffect)(function(){return m&&f&&i({id:f}),function(){E.resetFields()}},[f,m]);var P=function(){C(),E.resetFields()},j=function(){E.resetFields(),C(),g==null||g(),A()},U=(0,T.QT)(API.platform.sysOrg.update.fetch,{onSuccess:function(){j(),y.default.success("\u4FDD\u5B58\u6210\u529F")},manual:!0}),b=U.run,G=U.loading,v=(0,T.QT)(API.platform.sysOrg.save.fetch,{onSuccess:function(c){j(),c&&pe.default.success({message:"\u79DF\u6237\u65B0\u5EFA\u6210\u529F",description:"\u5BC6\u7801\u4E3A: ".concat(c),duration:null})},manual:!0}),l=v.run,a=v.loading,o=function(c){r("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var ce=(0,ae.HO)((0,R.Z)((0,R.Z)((0,R.Z)({},p),c),{},{logo:c.logo.map(function(me){return me.url||me.response.data.url})[0]}));return f?b(ce):l(ce)},D=(0,T.QT)(o,{manual:!0}),V=D.run,L=D.loading,K=Z||L||G||a;return t.createElement(I.Z,{centered:!0,visible:m,forceRender:!0,maskClosable:!1,title:"".concat((0,ge.Z)(f)?"\u65B0\u5EFA":"\u7F16\u8F91","\u4F01\u4E1A"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return E.submit()},onCancel:P,confirmLoading:K},t.createElement(le.Z,{spinning:K,tip:B},t.createElement(s.Z,(0,te.Z)({form:E,onFinish:V},ie,{className:Y().formWrap}),t.createElement(s.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"orgCode",tooltip:{icon:t.createElement(Ze.Z,null),title:`\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00
\u9700\u8981\u8F93\u516520\u4F4D\u4EE5\u5185\u5B57\u6BCD\uFF0C\u533A\u5206\u5927\u5C0F\u5199`},rules:[{whitespace:!0},{required:!0},{validator:_.T0}]},t.createElement(W.Z,{disabled:!!f,placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(s.Z.Item,{label:"\u4F01\u4E1A\u540D\u79F0",name:"orgName",rules:[{whitespace:!0},{required:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:Y().rowWrap},t.createElement(Ee.Z,{formItemProps:ie,label:"\u4F01\u4E1Alogo",name:"logo",maxCount:1,accept:ye.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20"},t.createElement(Ce.Z,null))),t.createElement("div",{className:Y().rowWrap},t.createElement(s.Z.Item,{label:"\u4F01\u4E1A\u4EE3\u7801",name:"enterpriseCode",rules:[{whitespace:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement(s.Z.Item,{label:"\u8D1F\u8D23\u4EBA",name:"director",rules:[{whitespace:!0},{required:!0}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(s.Z.Item,{label:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{required:!0},{validator:_.tH}]},t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"})),!!f&&t.createElement(s.Z.Item,{label:"\u7BA1\u7406\u5458\u8D26\u53F7",name:"directorUsername",rules:[{whitespace:!0},{validator:_.tH}]},t.createElement(W.Z,{disabled:!0,placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(s.Z.Item,{label:"\u6709\u6548\u671F",name:"validBefore",rules:[{required:!0}]},t.createElement(he.Z,{disabledDate:be})),!!f&&t.createElement(t.Fragment,null,t.createElement(s.Z.Item,{label:"\u72B6\u6001",name:"status",rules:[{whitespace:!0},{required:!0}]},t.createElement(ve.Z,{options:(0,ne.MM)(h.w6),placeholder:"\u8BF7\u9009\u62E9"})),t.createElement(s.Z.Item,{label:"\u5F53\u524D\u7528\u6237\u6570",name:"userNum",rules:[{whitespace:!0},{validator:_.tH}]},t.createElement(W.Z,{disabled:!0,placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement("div",{className:Ae()(Y().rowWrap,Y().description)},t.createElement(s.Z.Item,(0,te.Z)({label:"\u63CF\u8FF0",name:"description",rules:[{whitespace:!0},{required:!0}]},De),t.createElement(W.Z,{placeholder:"\u8BF7\u8F93\u5165"}))))))},Re=e(3911),se=e(46368),Te=e(78863),Me=e.n(Te),xe=e(96486),Be=e(24342),Pe={labelCol:{span:6},wrapperCol:{span:16}},Le=function(n){var m=n.visible,C=n.toggleVisible,p=n.formData,g=n.loading,M=n.reload,x=s.Z.useForm(),E=(0,q.Z)(x,1),u=E[0],B=(0,re.Z)(),r=B.tip,f=B.setTip,z=p.directorRoleId,A=(0,ue.tT)("resourceData"),S=A.resourceList,i=(0,T.QT)(function(l){return API.authorization.resource.listUserResourceData.fetch({clientKey:h.OW.clientId,roleId:l})},{manual:!0,onSuccess:function(a){var o=[];a.forEach(function(D){var V=D.id,L=D.privilegeList,K=L===void 0?[]:L;o.push(V),(0,se.Z)(K)||K.forEach(function(d){o.push(d.id)})}),u.setFieldsValue({resourceIds:o})}}),Z=i.run;(0,t.useEffect)(function(){m&&Z(z)},[m]),(0,t.useEffect)(function(){return(0,se.Z)(p)||u.setFieldsValue(p),function(){u.resetFields()}},[p]);var P=function(){C(),u.resetFields()},j=function(a){var o=a.resourceIds,D=o===void 0?[]:o,V=(0,Re.Z)(a,["resourceIds"]);f("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var L=(0,ae.HO)((0,R.Z)((0,R.Z)({},V),{},{clientKey:h.OW.clientId,id:z,resourceIds:D.filter(function(K){return(0,xe.isNumber)(K)})}));return API.platform.sysRole.resourceSave.fetch(L)},U=(0,T.QT)(j,{manual:!0,onSuccess:function(){y.default.success("\u4FDD\u5B58\u6210\u529F"),u.resetFields(),C(),M==null||M()}}),b=U.run,G=U.loading,v=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"description",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u6807\u8BC6",dataIndex:"resourceKey",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"type",align:"left",copyable:!1,valueType:"text",render:function(a){return a===h.o4.\u8DEF\u7531\u7EA7\u8D44\u6E90?"\u8DEF\u7531\u7EA7\u8D44\u6E90":"\u9875\u9762\u7EA7\u8D44\u6E90"}}];return t.createElement(I.Z,{centered:!0,visible:m,forceRender:!0,maskClosable:!1,title:"\u4F01\u4E1A\u6388\u6743",okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return u.submit()},onCancel:P,confirmLoading:G},t.createElement(le.Z,{spinning:g&&G,tip:r},t.createElement(s.Z,(0,te.Z)({form:u,onFinish:b},Pe,{className:Me().formWrap}),t.createElement(s.Z.Item,{label:"\u6743\u9650\u5217\u8868",name:"resourceIds",noStyle:!0},t.createElement(Be.Z,{search:!1,rowKey:"id",columns:v,dataSource:S})))))},de=e(89193),We=function(){var n=(0,t.useRef)(),m=(0,de.x)({visible:!1,formData:{},loading:!1}),C=(0,q.Z)(m,2),p=C[0],g=C[1],M=(0,de.x)({visible:!1,formData:{},loading:!1}),x=(0,q.Z)(M,2),E=x[0],u=x[1],B=n.current||{},r=B.reload,f=(0,T.QT)(API.platform.sysOrg.resetPassword.fetch,{manual:!0,onSuccess:function(){y.default.success("\u91CD\u7F6E\u6210\u529F"),r==null||r()}}),z=f.run,A=(0,T.QT)(API.platform.sysOrg.updateStatus.fetch,{manual:!0,onSuccess:function(){y.default.success("\u64CD\u4F5C\u6210\u529F"),r==null||r()}}),S=A.run,i=(0,T.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){y.default.success("\u5220\u9664\u6210\u529F"),r==null||r()}}),Z=i.run,P=function(){var v=(0,N.Z)(O().mark(function l(a){var o,D,V,L;return O().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,API.platform.sysOrg.pageList.fetch((0,ae.HO)((0,R.Z)((0,R.Z)({},a),{},{page:(a==null?void 0:a.current)||h.ii.page,pageSize:(a==null?void 0:a.pageSize)||h.ii.pageSize})));case 2:return o=d.sent,D=o.list,V=o.page,L=o.total,d.abrupt("return",{data:D||[],page:V,success:!0,total:L});case 7:case"end":return d.stop()}},l)}));return function(a){return v.apply(this,arguments)}}(),j=function(l){g(function(a){a.visible=!0,a.loading=!0,a.formData=l})},U=function(){g(function(l){l.visible=!0,l.formData={}})},b=function(l){u(function(a){a.visible=!0,a.loading=!0,a.formData=l})},G=function(l){var a={edit:g,auth:u};a[l](function(o){o.visible=!1,o.loading=!1,o.formData={}})};return{actionRef:n,reload:r,editModalConfig:p,setEditModalConfig:g,authModalConfig:E,setAuthModalConfig:u,handleDelete:Z,fetchList:P,handleCompanyEdit:j,handleUpdateStatus:S,handleResetPassword:z,handleCompanyAdd:U,handleAuthorize:b,handleModalHide:G}},ze=function(){var n=We(),m=n.actionRef,C=n.reload,p=n.editModalConfig,g=n.fetchList,M=n.handleResetPassword,x=n.handleUpdateStatus,E=n.handleCompanyAdd,u=n.handleCompanyEdit,B=n.handleModalHide,r=n.authModalConfig,f=n.handleAuthorize,z=[{title:"\u4F01\u4E1A\u7F16\u7801",dataIndex:"orgCode",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA",dataIndex:"director",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,ne.BJ)(h.w6)},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"date",hideInSearch:!1,hideInTable:!0},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(S,i){return t.createElement(fe.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return u(i)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return f(i)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return I.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return i.id&&x({status:h.w6.\u7981\u7528,id:"".concat(i.id)})}})},hidden:h.w6.\u7981\u7528===+i.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var Z=(0,N.Z)(O().mark(function j(){return O().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",i.id&&x({status:h.w6.\u6B63\u5E38,id:"".concat(i.id)}));case 1:case"end":return b.stop()}},j)}));function P(){return Z.apply(this,arguments)}return P}(),hidden:h.w6.\u7981\u7528!==+i.status},{name:"\u91CD\u7F6E\u5BC6\u7801",key:"reset",onClick:function(){return I.Z.confirm({title:"\u786E\u8BA4\u91CD\u7F6E\u5BC6\u7801\uFF1F",onOk:function(){return i.id&&M({id:"".concat(i.id)})}})}}]})}}];return t.createElement(t.Fragment,null,t.createElement(X.ZP,{style:{padding:"18px 22px"},actionRef:m,request:g,onRequestError:function(S){console.error(S.message),y.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(S.message))},columns:z,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u4F01\u4E1A\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(H.Z,{onClick:E,key:"add",type:"primary"},t.createElement(ee.Z,null),"\u65B0\u5EFA")]}}),t.createElement(Oe,{visible:p.visible,formData:p.formData,toggleVisible:function(){return B("edit")},reload:C}),t.createElement(Le,{visible:r.visible,formData:r.formData,loading:r.loading,toggleVisible:function(){return B("auth")},reload:C}))}}}]);
