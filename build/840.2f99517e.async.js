(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[840],{84664:function(H){H.exports={formWrap:"formWrap___276Lb",rowWrap:"rowWrap___1Q2qE",listWrap:"listWrap___2GzdK",userName:"userName___3K3PK"}},55632:function(H){H.exports={treeWrap:"treeWrap___LOi_-",cover:"cover___3a6dl"}},31567:function(H,j,e){"use strict";var ee=e(19597),x=e(2291),te=e(37482),v=e(3810),t=e(44742),o=e(67294),B=e(48786);j.Z=function(D){var Y=D.buttons,y=D.maxNumber,S=y===void 0?2:y,w=D.className,he=D.style,ne=Y.filter(function(n){return!n.hidden}),ae=ne.length,ge=function(l){var k=l,G=[];return l.length>S&&(k=l.slice(0,S-1),G=l.slice(S-1)),[k,G]},ie=(0,o.useMemo)(function(){return ge(ne)},[ne]),de=(0,t.Z)(ie,2),E=de[0],ce=de[1];return o.createElement("div",{className:w,style:he},E.map(function(n,l){var k=n.name,G=n.key,me=n.onClick,K=n.path,re=o.createElement("a",{style:{marginRight:18},key:G,onClick:K?function(){return B.m8.push(K)}:me},k);return l!==ae-1?o.createElement(o.Fragment,{key:G},re):re}),ce.length>0&&o.createElement(x.Z,{overlay:o.createElement(v.Z,null,ce.map(function(n){return o.createElement(v.Z.Item,{onClick:n.path?function(){return B.m8.push(n.path)}:function(){var l;return(l=n.onClick)===null||l===void 0?void 0:l.call(n)}},n.name)}))},o.createElement("a",null,"\u66F4\u591A")))}},57044:function(H,j,e){"use strict";var ee=e(87753),x=e(98570),te=e(67294);j.Z=function(v){var t=v.value,o=v.onChange,B=v.treeData,D=B===void 0?[]:B,Y=function(S){o==null||o(S)};return te.createElement(x.Z,{checkable:!0,defaultExpandAll:!0,onCheck:function(S){return Y(S)},checkedKeys:t,treeData:D})}},84850:function(H,j,e){"use strict";e.d(j,{Z:function(){return te}});var ee=e(44742),x=e(67294);function te(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=(0,x.useState)(!1),o=(0,ee.Z)(t,2),B=o[0],D=o[1],Y=(0,x.useState)(""),y=(0,ee.Z)(Y,2),S=y[0],w=y[1];return(0,x.useEffect)(function(){D(v)},[]),{spinning:B,setSpinning:D,tip:S,setTip:w}}},29840:function(H,j,e){"use strict";e.r(j),e.d(j,{default:function(){return Ne}});var ee=e(13753),x=e(48429),te=e(14643),v=e(92909),t=e(67294),o=e(21191),B=e(49101),D=e(31567),Y=e(26780),y=e(46567),S=e(58210),w=e(87240),he=e(37092),ne=e(91911),ae=e(13378),ge=e(68137),ie=e(50532),de=e(3911),E=e(56361),ce=e(67604),n=e(66498),l=e(44742),k=e(46368),G=e(46391),me=e(47376),K=e(66827),re=e(84850),De=e(48786),oe=e(66594),ye=e(57044),Re=e(55632),Ee=e.n(Re),pe=e(50189),Ie=function(i){var h=[];return i?(Object.keys(i).forEach(function(d){h.push.apply(h,(0,pe.Z)(i[d].map(function(s){return s.id})))}),h):[]},Me={labelCol:{span:3},wrapperCol:{span:20}},Ae={labelCol:{span:3},wrapperCol:{span:10}},Se=function(i){var h=i.visible,d=i.toggleVisible,s=i.formData,J=i.loading,F=i.reload,p=n.Z.useForm(),R=(0,l.Z)(p,1),c=R[0],g=(0,re.Z)(),C=g.tip,P=g.setTip,Z=s.id,M=(0,De.tT)("@@initialState"),z=M.initialState,N=z||{},O=N.authResourceData,L=N.userInfo,X=L||{},I=X.orgCode,u=(0,t.useState)(!1),a=(0,l.Z)(u,2),m=a[0],A=a[1];(0,t.useEffect)(function(){if(!(0,k.Z)(s)){var b=s||{},U=b.resourceMap,se=U===void 0?{}:U,ue=Ie(se);c.setFieldsValue((0,E.Z)((0,E.Z)({},s),{},{resourceIds:ue,modalResourceIds:ue}))}return function(){c.resetFields()}},[s]);var V=function(){d(),c.resetFields()},_=function(U){var se=U.resourceIds,ue=U.modalResourceIds,$=(0,de.Z)(U,["resourceIds","modalResourceIds"]);P("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var f=(0,E.Z)((0,E.Z)({},$),{},{clientKey:oe.OW.clientId,id:Z,businessValue:I,resourceIds:se.filter(function(W){return(0,G.Z)(W)})});return API.authorization.resourceRole.resourceSave.fetch(f)},le=(0,K.QT)(_,{manual:!0,onSuccess:function(){v.default.success("\u4FDD\u5B58\u6210\u529F"),c.resetFields(),d(),F==null||F()}}),T=le.run,q=le.loading;return t.createElement(n.Z,(0,ae.Z)({form:c,onFinish:T},Ae),t.createElement(y.Z,{centered:!0,visible:h,forceRender:!0,maskClosable:!1,title:"".concat((0,me.Z)(Z)?"\u65B0\u5EFA":"\u7F16\u8F91","\u89D2\u8272"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return c.submit()},onCancel:V,confirmLoading:q},t.createElement(w.Z,{spinning:J&&q,tip:C},t.createElement(n.Z.Item,{label:"\u89D2\u8272\u540D\u79F0",name:"role",rules:[{whitespace:!0},{required:!0}]},t.createElement(ie.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(n.Z.Item,(0,ae.Z)({label:"\u89D2\u8272\u63CF\u8FF0",name:"comment"},Me,{rules:[{whitespace:!0}]}),t.createElement(ie.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:Ee().treeWrap},t.createElement("div",{className:Ee().cover,onClick:function(){return A(!0)}}),t.createElement(n.Z.Item,{label:"\u62E5\u6709\u8D44\u6E90",name:"resourceIds"},t.createElement(ne.Z,{treeData:O,allowClear:!0,multiple:!0,placeholder:"\u8BF7\u9009\u62E9"}))))),t.createElement(y.Z,{centered:!0,visible:m,forceRender:!0,maskClosable:!1,title:"\u62E5\u6709\u8D44\u6E90",width:412,onOk:function(){c.setFieldsValue({resourceIds:c.getFieldValue("modalResourceIds")}),A(!1)},onCancel:function(){c.setFieldsValue({modalResourceIds:c.getFieldValue("resourceIds")}),A(!1)},confirmLoading:q},t.createElement(n.Z.Item,{label:"\u62E5\u6709\u8D44\u6E90",name:"modalResourceIds",noStyle:!0},t.createElement(ye.Z,{treeData:O}))))},Fe=Se,Ue=e(66518),Ce=e(95322),$e=e(44862),Pe=e(42091),Oe=e(3855),Le=e(84664),fe=e.n(Le),ve=e(89193),Te={page:1,pageSize:6},be={labelCol:{span:6},wrapperCol:{span:16}},We=function(r){var i=r.visible,h=r.toggleVisible,d=r.formData,s=r.reload,J=n.Z.useForm(),F=(0,l.Z)(J,1),p=F[0],R=(0,re.Z)(),c=R.tip,g=R.setTip,C=d.id,P=(0,t.useState)([]),Z=(0,l.Z)(P,2),M=Z[0],z=Z[1],N=(0,ve.x)(Te),O=(0,l.Z)(N,2),L=O[0],X=O[1],I=(0,K.QT)(API.platform.sysUser.pageList.fetch,{manual:!0}),u=I.data,a=I.run,m=I.loading,A=(0,K.QT)(API.authorization.resourceRole.resourceRoleDetailUser.fetch,{manual:!0,onSuccess:function(f){var W=f.userIdList,Q=W===void 0?[]:W;z(Q)}}),V=A.run,_=A.loading;(0,t.useEffect)(function(){i&&(a(L),V({clientKey:oe.OW.clientId,roleId:C}))},[i,L]),(0,t.useEffect)(function(){return(0,k.Z)(d)||p.setFieldsValue((0,E.Z)({},d)),function(){p.resetFields()}},[d]);var le=function(){h(),p.resetFields()},T=function(){return g("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019..."),API.authorization.resourceRole.resourceSave.fetch({clientKey:oe.OW.clientId,id:C,userIds:M.map(function(f){return+f}),resourceIds:d.resourceIds,role:d.role})},q=(0,K.QT)(T,{manual:!0,onSuccess:function(){v.default.success("\u6388\u6743\u6210\u529F"),p.resetFields(),h(),s==null||s()}}),b=q.run,U=q.loading,se=function(f,W){var Q=(0,pe.Z)(M);f.target.checked?Q.push(+W.userId):Q=Q.filter(function(Ve){return Ve!==W.userId}),z(Q)},ue=function(f){return t.createElement(Ce.ZP.Item,null,t.createElement(Pe.Z,{checked:M.includes(+f.userId),onChange:function(Q){return se(Q,f)}},t.createElement("div",{className:fe().userName},f.userName,f.phone?"(".concat(f.phone.slice(-4),")"):"")))};return t.createElement(y.Z,{centered:!0,visible:i,forceRender:!0,maskClosable:!1,title:"\u7528\u6237\u6388\u6743",okButtonProps:{htmlType:"submit"},width:442,onOk:function(){return p.submit()},onCancel:le,confirmLoading:U,wrapClassName:"auth-modal"},t.createElement(w.Z,{spinning:m&&U&&_,tip:c},t.createElement(n.Z,(0,ae.Z)({form:p,onFinish:b},be,{className:fe().formWrap}),t.createElement(n.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"account",tooltip:{icon:t.createElement(Oe.Z,null),title:"\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00"},noStyle:!0},t.createElement(Ce.ZP,{loading:m,className:fe().listWrap,size:"small",dataSource:u==null?void 0:u.list,pagination:(0,E.Z)((0,E.Z)({},L),{},{current:L.page,onChange:function(f){X(function(W){W.page=f})},showQuickJumper:!0}),renderItem:ue})))))},xe=e(68699),Be=e(94043),Ze=e.n(Be),Ke=e(27870),ze=function(){var r=(0,t.useRef)(),i=(0,ve.x)({visible:!1,formData:{},loading:!1}),h=(0,l.Z)(i,2),d=h[0],s=h[1],J=(0,ve.x)({visible:!1,formData:{}}),F=(0,l.Z)(J,2),p=F[0],R=F[1],c=r.current||{},g=c.reload,C=(0,K.QT)(API.authorization.role.update.fetch,{manual:!0,onSuccess:function(){v.default.success("\u64CD\u4F5C\u6210\u529F"),g==null||g()}}),P=C.run,Z=(0,K.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){v.default.success("\u5220\u9664\u6210\u529F"),g==null||g()}}),M=Z.run,z=function(){var I=(0,xe.Z)(Ze().mark(function u(a){var m,A,V,_;return Ze().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,API.platform.sysRole.pageList.fetch((0,Ke.HO)((0,E.Z)((0,E.Z)({},a),{},{page:(a==null?void 0:a.current)||oe.ii.page,pageSize:(a==null?void 0:a.pageSize)||oe.ii.pageSize})));case 2:return m=T.sent,A=m.list,V=m.page,_=m.total,T.abrupt("return",{data:A||[],page:V,success:!0,total:_});case 7:case"end":return T.stop()}},u)}));return function(a){return I.apply(this,arguments)}}(),N=function(u){s(function(a){a.visible=!0,a.loading=!0,a.formData=u})},O=function(){s(function(u){u.visible=!0,u.formData={}})},L=function(u){var a=u||{},m=a.resourceMap,A=Ie(m);R(function(V){V.visible=!0,V.formData=(0,E.Z)((0,E.Z)({},u),{},{resourceIds:A})})},X=function(u){var a={edit:s,auth:R};a[u](function(m){m.visible=!1,m.loading=!1,m.formData={}})};return{actionRef:r,reload:g,editModalConfig:d,setEditModalConfig:s,authModalConfig:p,setAuthModalConfig:R,handleDisable:P,handleDelete:M,fetchList:z,handleRoleEdit:N,handleRoleAdd:O,handleAuthorize:L,handleModalHide:X}},Ne=function(){var r=ze(),i=r.actionRef,h=r.reload,d=r.editModalConfig,s=r.fetchList,J=r.handleRoleAdd,F=r.handleRoleEdit,p=r.handleModalHide,R=r.authModalConfig,c=r.handleAuthorize,g=[{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"role",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u89D2\u8272\u63CF\u8FF0",dataIndex:"comment",align:"left",copyable:!1,valueType:"text",hideInSearch:!0},{title:"\u62E5\u6709\u8D44\u6E90",dataIndex:"resourceList",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(P,Z){var M=Z||{},z=M.resourceMap,N=z===void 0?[]:z,O=[];return Object.keys(N).forEach(function(L){N[L].forEach(function(X){O.push(X.description)})}),O.join(",")}},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(P,Z){return t.createElement(D.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return F(Z)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return c(Z)}}]})}}];return t.createElement(t.Fragment,null,t.createElement(o.ZP,{style:{padding:"18px 22px"},actionRef:i,request:s,onRequestError:function(P){console.error(P.message),v.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(P.message))},columns:g,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u83DC\u5355\u6743\u9650\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(x.Z,{onClick:J,key:"add",type:"primary"},t.createElement(B.Z,null),"\u65B0\u5EFA")]}}),t.createElement(Fe,{visible:d.visible,formData:d.formData,loading:d.loading,toggleVisible:function(){return p("edit")},reload:h}),t.createElement(We,{visible:R.visible,formData:R.formData,toggleVisible:function(){return p("auth")},reload:h}))}}}]);
