"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[105],{62571:function(e,t,n){var a=n(5574),r=n.n(a),l=n(67294),i=n(13013),u=n(66516),o=n(84354),c=n(85893);t.Z=function(e){var t=e.buttons,n=e.maxNumber,a=void 0===n?2:n,s=e.className,d=e.style,p=t.filter((function(e){return!e.hidden})),f=p.length,h=(0,l.useMemo)((function(){return function(e){var t=e,n=[];return e.length>a&&(t=e.slice(0,a-1),n=e.slice(a-1)),[t,n]}(p)}),[p]),m=r()(h,2),g=m[0],v=m[1];return(0,c.jsxs)("div",{className:s,style:d,children:[g.map((function(e,t){var n=e.name,a=e.key,r=e.onClick,i=e.path,u=(0,c.jsx)("a",{style:{marginRight:18},onClick:i?function(){return o.history.push(i)}:r,children:n},a);return t!==f-1?(0,c.jsx)(l.Fragment,{children:u},a):u})),v.length>0&&(0,c.jsx)(i.Z,{overlay:(0,c.jsx)(u.Z,{children:v.map((function(e){return(0,c.jsx)(u.Z.Item,{onClick:e.path?function(){return o.history.push(e.path)}:function(){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e)},children:e.name})}))}),children:(0,c.jsx)("a",{children:"更多"})})]})}},39284:function(e,t,n){n.d(t,{Z:function(){return i}});var a=n(43758),r=n(67294),l=n(84354);function i(){var e=((0,l.useModel)("@@initialState").initialState||{}).privileges,t=void 0===e?[]:e;return{templateAuthMap:(0,r.useMemo)((function(){var e={};return a.GT.forEach((function(n){var a=n.name,r=n.key;e[a]=t.some((function(e){return e.resourceKey===r}))})),e}),[t])}}},9483:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var a=n(9783),r=n.n(a),l=n(34041),i=n(12461),u=n(9308),o=n(43758),c=n(62571),s=n(15009),d=n.n(s),p=n(97857),f=n.n(p),h=n(99289),m=n.n(h),g=n(67294),v=n(86317),x=n(41712),y=n(39284),I=n(14955),T=n(85893),k=function(){var e,t=function(){var e=(0,g.useRef)(),t=(e.current||{}).reload,n=(0,y.Z)().templateAuthMap,a=(0,v.QT)(API.platform.template.listAllTemplatePackage.fetch).data,r=void 0===a?[]:a,l=function(){var e=m()(d()().mark((function e(t){var n,a,r,l;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,API.platform.template.listTemplate.fetch((0,x.HO)(f()(f()({},t),{},{page:(null==t?void 0:t.current)||o.ii.page,pageSize:(null==t?void 0:t.pageSize)||o.ii.pageSize})));case 2:return n=e.sent,a=n.list,r=n.page,l=n.total,e.abrupt("return",{data:a||[],page:r,success:!0,total:l});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=(0,v.QT)(API.platform.template.createTemplate.fetch,{manual:!0,onSuccess:function(){i.ZP.success("操作成功"),null==t||t()}}),c=u.run;return{loading:u.loading,actionRef:e,reload:t,handleTemplateRetry:c,fetchList:l,templatePackageList:r,templateAuthMap:n}}(),n=t.actionRef,a=t.templatePackageList,s=t.templateAuthMap,p=t.fetchList,h=t.handleTemplateRetry,k=[{title:function(e,t){return"form"===t?"关键字":"模板缩略图"},dataIndex:"keyword",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,order:3,render:function(e,t){return(0,T.jsx)("img",{alt:"模板缩略图",src:t.templatePicture,width:72})}},{title:"模板套餐名称",dataIndex:"packageName",align:"left",copyable:!1,valueType:"text",hideInSearch:!0},{title:"套餐",dataIndex:"packageId",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,hideInTable:!0,order:1,renderFormItem:function(){return(0,T.jsx)(l.Z,{allowClear:!0,children:null==a?void 0:a.map((function(e){return(0,T.jsx)(l.Z.Option,{value:null==e?void 0:e.id,children:null==e?void 0:e.name},null==e?void 0:e.id)}))})}},{title:function(e,t){return"form"===t?"子系统":"所属子系统"},dataIndex:"clientKey",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,order:2,valueEnum:(0,I.BJ)(o.EN)},{title:"标签",dataIndex:"templateTags",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(e,t){return JSON.parse((null==t?void 0:t.templateTags)||"[]").join("、")}},{title:"创建时间",dataIndex:"createTime",align:"left",copyable:!1,valueType:"text",hideInSearch:!0},{title:"状态",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,valueEnum:(e={},r()(e,o.KL["失败"],{text:"失败",status:"Error"}),r()(e,o.KL["成功"],{text:"成功",status:"Success"}),r()(e,o.KL["创建中"],{text:"创建中",status:"Processing"}),r()(e,o.KL["未创建"],{text:"未创建",status:"Processing"}),e)},{title:"操作",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(e,t){return t.status===o.KL["失败"]&&s["模板重试"]&&(0,T.jsx)(c.Z,{buttons:[{name:"重试",key:"retry",onClick:function(){return h({orgTemplateId:null==t?void 0:t.orgTemplateId})}}]})}}];return(0,T.jsx)(u.ZP,{style:{padding:"18px 22px"},actionRef:n,request:p,onRequestError:function(e){console.error(e.message),i.ZP.error("数据加载失败,".concat(e.message))},columns:k,bordered:!0,rowKey:"orgTemplateId",pagination:{size:"default"},dateFormatter:"string",headerTitle:"模板历史",tableAlertRender:!1})}}}]);