(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[722],{46769:function(b){b.exports={formWrap:"formWrap___26yWO",uploadWrap:"uploadWrap___G6C_G"}},68504:function(b,H,e){"use strict";e.r(H),e.d(H,{default:function(){return de}});var ce=e(13753),J=e(48429),me=e(14643),B=e(92909),$=e(68699),fe=e(26780),W=e(46567),ve=e(97140),D=e(93228),K=e(94043),M=e.n(K),t=e(67294),X=e(21191),d=e(66594),Y=e(49101),L=e(96689),k=e(31567),he=e(58210),w=e(87240),q=e(13378),pe=e(68137),A=e(50532),v=e(56361),ge=e(67604),h=e(66498),z=e(44742),_=e(46368),ee=e(47376),P=e(66827),te=e(84850),ae=e(3678),ne=e(12049),le=e(32615),re=e(46769),G=e.n(re),N=e(42348),V=e(27870),j={labelCol:{span:6},wrapperCol:{span:16}},se=function(m){var C=m.visible,y=m.toggleVisible,l=m.formData,p=m.loading,E=m.reload,i=h.Z.useForm(),x=(0,z.Z)(i,1),a=x[0],Z=(0,te.Z)(),T=Z.tip,I=Z.setTip,F=l.id;(0,t.useEffect)(function(){return(0,_.Z)(l)||a.setFieldsValue((0,v.Z)((0,v.Z)({},l),{},{avatar:l!=null&&l.avatar?[{uid:"1",name:"\u5934\u50CF",status:"done",url:l==null?void 0:l.avatar,size:0}]:[]})),function(){a.resetFields()}},[l]);var S=function(){y(),a.resetFields()},U=function(c){I("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var s=(0,V.HO)((0,v.Z)((0,v.Z)((0,v.Z)({},l),c),{},{avatar:c.avatar.map(function(f){return f.url||f.response.data.url})[0]}));return F?API.platform.sysUser.update.fetch((0,v.Z)({},s)):API.platform.sysUser.save.fetch(s)},o=(0,P.QT)(U,{manual:!0,onSuccess:function(){B.default.success("\u4FDD\u5B58\u6210\u529F"),a.resetFields(),y(),E==null||E()}}),r=o.run,n=o.loading;return t.createElement(W.Z,{centered:!0,visible:C,forceRender:!0,maskClosable:!1,title:"".concat((0,ee.Z)(F)?"\u65B0\u589E":"\u7F16\u8F91","\u7528\u6237"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return a.submit()},onCancel:S,confirmLoading:n},t.createElement(w.Z,{spinning:p&&n,tip:T},t.createElement(h.Z,(0,q.Z)({form:a,onFinish:r},j,{className:G().formWrap}),t.createElement(h.Z.Item,{label:"\u767B\u5F55\u8D26\u53F7",name:"userName",rules:[{whitespace:!0},{required:!0}]},t.createElement(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(h.Z.Item,{label:"\u7528\u6237\u6635\u79F0",name:"name",rules:[{whitespace:!0}]},t.createElement(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(h.Z.Item,{label:"\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{required:!0},{validator:N.tH}]},t.createElement(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(h.Z.Item,{label:"\u90AE\u7BB1",name:"email",rules:[{whitespace:!0},{validator:N.Le}]},t.createElement(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:G().uploadWrap},t.createElement(ae.Z,{formItemProps:j,label:"\u5934\u50CF",name:"avatar",maxCount:1,accept:ne.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20\u5934\u50CF"},t.createElement(le.Z,null))),t.createElement(h.Z.Item,{label:"\u6027\u522B",name:"sex"},t.createElement(D.Z,{placeholder:"\u8BF7\u9009\u62E9",options:(0,L.MM)(d.TG)})),t.createElement(h.Z.Item,{label:"\u72B6\u6001",name:"status"},t.createElement(D.Z,{placeholder:"\u8BF7\u9009\u62E9",options:(0,L.MM)(d.w6)})))))},ue=e(89193),ie=function(){var m=(0,t.useRef)(),C=(0,ue.x)({visible:!1,formData:{},loading:!1}),y=(0,z.Z)(C,2),l=y[0],p=y[1],E=m.current||{},i=E.reload,x=(0,P.QT)(API.platform.sysUser.updateStatus.fetch,{manual:!0,onSuccess:function(){B.default.success("\u64CD\u4F5C\u6210\u529F"),i==null||i()}}),a=x.run,Z=(0,P.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){B.default.success("\u5220\u9664\u6210\u529F"),i==null||i()}}),T=Z.run,I=function(){var o=(0,$.Z)(M().mark(function r(n){var u,c,s,f;return M().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,API.platform.sysUser.pageList.fetch((0,V.HO)((0,v.Z)((0,v.Z)({},n),{},{page:(n==null?void 0:n.current)||d.ii.page,pageSize:(n==null?void 0:n.pageSize)||d.ii.pageSize})));case 2:return u=g.sent,c=u.list,s=u.page,f=u.total,g.abrupt("return",{data:c||[],page:s,success:!0,total:f});case 7:case"end":return g.stop()}},r)}));return function(n){return o.apply(this,arguments)}}(),F=function(r){p(function(n){n.visible=!0,n.loading=!0,n.formData=r})},S=function(){p(function(r){r.visible=!0,r.formData={}})},U=function(){return p(function(r){r.visible=!1,r.loading=!1,r.formData={}})};return{actionRef:m,reload:i,editModalConfig:l,handleUpdateStatus:a,handleDelete:T,fetchList:I,handleUserAdd:S,handleUserEdit:F,handleModalHide:U}},Q=e(48786),oe=function(){var C=(0,Q.tT)("@@initialState"),y=C.initialState,l=y||{},p=l.userInfo,E=p===void 0?{}:p,i=(0,Q.tT)("company"),x=i.companyMapOptions,a=ie(),Z=a.actionRef,T=a.reload,I=a.editModalConfig,F=a.fetchList,S=a.handleUpdateStatus,U=a.handleUserAdd,o=a.handleUserEdit,r=a.handleModalHide,n=[{title:"\u767B\u5F55\u8D26\u53F7",dataIndex:"userName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u7528\u6237\u6635\u79F0",dataIndex:"name",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgId",align:"left",copyable:!1,valueType:"text",hideInSearch:!!E.orgId,hideInTable:!0,renderFormItem:function(){return t.createElement(D.Z,{allowClear:!0,options:x})}},{title:"\u624B\u673A\u53F7",dataIndex:"phone",align:"left",valueType:"text",hideInSearch:!1,hideInTable:!0},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!0},{title:"\u90AE\u7BB1",dataIndex:"email",align:"left",copyable:!1,valueType:"text",hideInSearch:!0},{title:"\u5934\u50CF",dataIndex:"avatar",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(c,s){return t.createElement("img",{alt:"\u5934\u50CF",src:s.avatar,width:72})}},{title:"\u6027\u522B",dataIndex:"sex",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,valueEnum:d.TG},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,L.BJ)(d.w6)},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(c,s){return t.createElement(k.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return o(s)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return W.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return s.id&&S({status:d.w6.\u7981\u7528,id:s.id})}})},hidden:d.w6.\u7981\u7528===+s.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var f=(0,$.Z)(M().mark(function g(){return M().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",s.id&&S({status:d.w6.\u6B63\u5E38,id:s.id}));case 1:case"end":return R.stop()}},g)}));function O(){return f.apply(this,arguments)}return O}(),hidden:d.w6.\u7981\u7528!==+s.status}]})}}];return t.createElement(t.Fragment,null,t.createElement(X.ZP,{style:{padding:"18px 22px"},actionRef:Z,request:F,onRequestError:function(c){console.error(c.message),B.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(c.message))},columns:n,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u7528\u6237\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(J.Z,{onClick:U,key:"add",type:"primary"},t.createElement(Y.Z,null),"\u65B0\u5EFA")]}}),t.createElement(se,{visible:I.visible,formData:I.formData,loading:I.loading,toggleVisible:r,reload:T}))},de=oe}}]);
