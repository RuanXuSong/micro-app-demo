(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[553,722],{46769:function(W){W.exports={formWrap:"formWrap___26yWO",uploadWrap:"uploadWrap___G6C_G"}},31261:function(W,R,e){"use strict";e.d(R,{Z:function(){return V}});var N=e(67294),H=e(48786);function V(h){var L=(0,H.tT)("@@initialState"),j=L.initialState,P=j||{},$=P.privileges,E=$===void 0?[]:$,b=(0,N.useMemo)(function(){return E.some(function(I){return I.resourceKey===h})},[E,h]);return{showCompanySelect:b}}},68504:function(W,R,e){"use strict";e.r(R),e.d(R,{default:function(){return fe}});var N=e(13753),H=e(48429),V=e(14643),h=e(92909),L=e(68699),j=e(26780),P=e(46567),$=e(97140),E=e(93228),b=e(94043),I=e.n(b),t=e(67294),k=e(87542),d=e(66594),w=e(49101),z=e(96689),q=e(31567),he=e(58210),_=e(87240),ee=e(13378),pe=e(68137),O=e(50532),m=e(56361),ye=e(67604),v=e(66498),K=e(44742),te=e(46368),ae=e(47376),G=e(66827),ne=e(84850),le=e(3678),re=e(95951),se=e(32615),ue=e(46769),Q=e.n(ue),J=e(42348),X=e(27870),Y={labelCol:{span:6},wrapperCol:{span:16}},oe=function(c){var x=c.visible,p=c.toggleVisible,l=c.formData,y=c.loading,r=c.reload,i=v.Z.useForm(),U=(0,K.Z)(i,1),u=U[0],Z=(0,ne.Z)(),S=Z.tip,M=Z.setTip,F=l.id;(0,t.useEffect)(function(){return(0,te.Z)(l)||u.setFieldsValue((0,m.Z)((0,m.Z)({},l),{},{avatar:l!=null&&l.avatar?[{uid:"1",name:"\u5934\u50CF",status:"done",url:l==null?void 0:l.avatar,size:0}]:[]})),function(){u.resetFields()}},[l]);var B=function(){p(),u.resetFields()},A=function(f){M("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var g=(0,X.HO)((0,m.Z)((0,m.Z)((0,m.Z)({},l),f),{},{avatar:f.avatar.map(function(C){return C.url||C.response.data.url})[0]}));return F?API.platform.sysUser.update.fetch((0,m.Z)({},g)):API.platform.sysUser.save.fetch(g)},s=(0,G.QT)(A,{manual:!0,onSuccess:function(){h.default.success("\u4FDD\u5B58\u6210\u529F"),u.resetFields(),p(),r==null||r()}}),n=s.run,a=s.loading;return t.createElement(P.Z,{centered:!0,visible:x,forceRender:!0,maskClosable:!1,title:"".concat((0,ae.Z)(F)?"\u65B0\u589E":"\u7F16\u8F91","\u7528\u6237"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return u.submit()},onCancel:B,confirmLoading:a},t.createElement(_.Z,{spinning:y&&a,tip:S},t.createElement(v.Z,(0,ee.Z)({form:u,onFinish:n},Y,{className:Q().formWrap}),t.createElement(v.Z.Item,{label:"\u767B\u5F55\u8D26\u53F7",name:"userName",rules:[{whitespace:!0},{required:!0}]},t.createElement(O.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(v.Z.Item,{label:"\u7528\u6237\u6635\u79F0",name:"name",rules:[{whitespace:!0}]},t.createElement(O.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(v.Z.Item,{label:"\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{required:!0},{validator:J.tH}]},t.createElement(O.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(v.Z.Item,{label:"\u90AE\u7BB1",name:"email",rules:[{whitespace:!0},{validator:J.Le}]},t.createElement(O.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:Q().uploadWrap},t.createElement(le.Z,{formItemProps:Y,label:"\u5934\u50CF",name:"avatar",maxCount:1,accept:re.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20\u5934\u50CF"},t.createElement(se.Z,null))),t.createElement(v.Z.Item,{label:"\u6027\u522B",name:"sex"},t.createElement(E.Z,{placeholder:"\u8BF7\u9009\u62E9",options:(0,z.MM)(d.TG)})),t.createElement(v.Z.Item,{label:"\u72B6\u6001",name:"status"},t.createElement(E.Z,{placeholder:"\u8BF7\u9009\u62E9",options:(0,z.MM)(d.w6)})))))},ie=e(89193),de=function(){var c=(0,t.useRef)(),x=(0,ie.x)({visible:!1,formData:{},loading:!1}),p=(0,K.Z)(x,2),l=p[0],y=p[1],r=c.current||{},i=r.reload,U=(0,G.QT)(API.platform.sysUser.updateStatus.fetch,{manual:!0,onSuccess:function(){h.default.success("\u64CD\u4F5C\u6210\u529F"),i==null||i()}}),u=U.run,Z=(0,G.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){h.default.success("\u5220\u9664\u6210\u529F"),i==null||i()}}),S=Z.run,M=function(){var s=(0,L.Z)(I().mark(function n(a){var o,f,g,C;return I().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,API.platform.sysUser.pageList.fetch((0,X.HO)((0,m.Z)((0,m.Z)({},a),{},{page:(a==null?void 0:a.current)||d.ii.page,pageSize:(a==null?void 0:a.pageSize)||d.ii.pageSize})));case 2:return o=T.sent,f=o.list,g=o.page,C=o.total,T.abrupt("return",{data:f||[],page:g,success:!0,total:C});case 7:case"end":return T.stop()}},n)}));return function(a){return s.apply(this,arguments)}}(),F=function(n){y(function(a){a.visible=!0,a.loading=!0,a.formData=n})},B=function(){y(function(n){n.visible=!0,n.formData={}})},A=function(){return y(function(n){n.visible=!1,n.loading=!1,n.formData={}})};return{actionRef:c,reload:i,editModalConfig:l,handleUpdateStatus:u,handleDelete:S,fetchList:M,handleUserAdd:B,handleUserEdit:F,handleModalHide:A}},ce=e(48786),me=e(31261),ve=function(){var x=(0,me.Z)("auth_user_list_company"),p=x.showCompanySelect,l=(0,ce.tT)("company"),y=l.companyIdMapOptions,r=de(),i=r.actionRef,U=r.reload,u=r.editModalConfig,Z=r.fetchList,S=r.handleUpdateStatus,M=r.handleUserAdd,F=r.handleUserEdit,B=r.handleModalHide,A=[{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgId",align:"left",copyable:!1,valueType:"text",hideInSearch:!p,hideInTable:!0,renderFormItem:function(){return t.createElement(E.Z,{allowClear:!0,options:y})}},{title:"\u767B\u5F55\u8D26\u53F7",dataIndex:"userName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u7528\u6237\u6635\u79F0",dataIndex:"name",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u624B\u673A\u53F7",dataIndex:"phone",align:"left",valueType:"text",hideInSearch:!1,hideInTable:!0},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!0},{title:"\u90AE\u7BB1",dataIndex:"email",align:"left",copyable:!1,valueType:"text",hideInSearch:!0},{title:"\u5934\u50CF",dataIndex:"avatar",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(n,a){return t.createElement("img",{alt:"\u5934\u50CF",src:a.avatar,width:72})}},{title:"\u6027\u522B",dataIndex:"sex",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,valueEnum:d.TG},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,z.BJ)(d.w6)},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(n,a){return t.createElement(q.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return F(a)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return P.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return a.id&&S({status:d.w6.\u7981\u7528,id:a.id})}})},hidden:d.w6.\u7981\u7528===+a.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var o=(0,L.Z)(I().mark(function g(){return I().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",a.id&&S({status:d.w6.\u6B63\u5E38,id:a.id}));case 1:case"end":return D.stop()}},g)}));function f(){return o.apply(this,arguments)}return f}(),hidden:d.w6.\u7981\u7528!==+a.status}]})}}];return t.createElement(t.Fragment,null,t.createElement(k.ZP,{style:{padding:"18px 22px"},actionRef:i,request:Z,onRequestError:function(n){console.error(n.message),h.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(n.message))},columns:A,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u7528\u6237\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(H.Z,{onClick:M,key:"add",type:"primary"},t.createElement(w.Z,null),"\u65B0\u5EFA")]}}),t.createElement(oe,{visible:u.visible,formData:u.formData,loading:u.loading,toggleVisible:B,reload:U}))},fe=ve}}]);
