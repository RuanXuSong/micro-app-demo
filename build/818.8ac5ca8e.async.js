(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[818],{34950:function(B,Z){"use strict";Object.defineProperty(Z,"__esModule",{value:!0});var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};Z.default=e},3855:function(B,Z,e){"use strict";var J,P=e(95318),X=e(20862);J={value:!0},Z.Z=void 0;var I=X(e(67294)),V=P(e(34950)),K=P(e(92074)),b=function(t,Q){return I.createElement(K.default,Object.assign({},t,{ref:Q,icon:V.default}))};b.displayName="ExclamationCircleOutlined";var H=I.forwardRef(b);Z.Z=H},78863:function(B){B.exports={formWrap:"formWrap___3eS8c",rowWrap:"rowWrap___3VEOz",description:"description___bi6uK"}},79920:function(B){B.exports={formWrap:"formWrap___19ekr",rowWrap:"rowWrap___1jzhp",description:"description___2a_68"}},24342:function(B,Z,e){"use strict";var J=e(13378),P=e(56361),X=e(3911),I=e(67294),V=e(87542);Z.Z=function(K){var b=K.value,H=b===void 0?[]:b,D=K.onChange,t=(0,X.Z)(K,["value","onChange"]),Q={selectedRowKeys:H,onChange:function(w){D==null||D(w)}};return I.createElement(V.ZP,(0,J.Z)({rowSelection:(0,P.Z)((0,P.Z)({},Q),{},{checkStrictly:!0})},t))}},39818:function(B,Z,e){"use strict";e.r(Z),e.d(Z,{default:function(){return Te}});var J=e(13753),P=e(48429),X=e(14643),I=e(92909),V=e(68699),K=e(26780),b=e(46567),H=e(94043),D=e.n(H),t=e(67294),Q=e(87542),h=e(66594),w=e(49101),oe=e(96689),ue=e(31567),Re=e(58210),te=e(87240),q=e(13378),Be=e(74393),ie=e(88995),Pe=e(68137),$=e(50532),O=e(56361),We=e(67604),c=e(66498),Y=e(44742),_=e(46368),se=e(47376),W=e(66827),ae=e(84850),de=e(3678),ce=e(95951),me=e(32615),fe=e(3855),ve=e(79920),G=e.n(ve),he=e(42348),pe=e(35510),ge=e.n(pe),Ee=e(56051),ye=e.n(Ee),ee=e(27870),ne=e(48786),le={labelCol:{span:8},wrapperCol:{span:14}},Ce={labelCol:{span:4},wrapperCol:{span:19}},Ze=function(a){var M=a.visible,p=a.toggleVisible,n=a.formData,F=a.loading,m=a.reload,x=c.Z.useForm(),L=(0,Y.Z)(x,1),r=L[0],g=(0,ae.Z)(),d=g.tip,z=g.setTip,f=n.id,T=(0,ne.tT)("company"),i=T.reloadCompanyData;(0,t.useEffect)(function(){return(0,_.Z)(n)||r.setFieldsValue((0,O.Z)((0,O.Z)({},n),{},{validBefore:n.validBefore?ye()(n.validBefore):null,logo:n!=null&&n.logo?[{uid:"1",name:"logo",status:"done",url:n==null?void 0:n.logo,size:0}]:[]})),function(){r.resetFields()}},[n]);var A=function(){p(),r.resetFields()},R=(0,W.QT)(API.platform.sysOrg.update.fetch,{onSuccess:function(){return i()},manual:!0}),j=R.run,N=(0,W.QT)(API.platform.sysOrg.save.fetch,{onSuccess:function(){return i()},manual:!0}),E=N.run,y=function(v){z("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var S=(0,ee.HO)((0,O.Z)((0,O.Z)((0,O.Z)({},n),v),{},{logo:v.logo.map(function(U){return U.url||U.response.data.url})[0]}));return f?j(S):E(S)},u=(0,W.QT)(y,{manual:!0,onSuccess:function(){I.default.success("\u4FDD\u5B58\u6210\u529F"),r.resetFields(),p(),m==null||m()}}),l=u.run,o=u.loading;return t.createElement(b.Z,{centered:!0,visible:M,forceRender:!0,maskClosable:!1,title:"".concat((0,se.Z)(f)?"\u65B0\u5EFA":"\u7F16\u8F91","\u4F01\u4E1A"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return r.submit()},onCancel:A,confirmLoading:o},t.createElement(te.Z,{spinning:F&&o,tip:d},t.createElement(c.Z,(0,q.Z)({form:r,onFinish:l},le,{className:G().formWrap}),t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"orgCode",tooltip:{icon:t.createElement(fe.Z,null),title:"\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00"},rules:[{whitespace:!0},{required:!0}]},t.createElement($.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u540D\u79F0",name:"orgName",rules:[{whitespace:!0}]},t.createElement($.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:G().rowWrap},t.createElement(de.Z,{formItemProps:le,label:"\u4F01\u4E1Alogo",name:"logo",maxCount:1,accept:ce.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20"},t.createElement(me.Z,null))),t.createElement("div",{className:G().rowWrap},t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u4EE3\u7801",name:"enterpriseCode",rules:[{whitespace:!0}]},t.createElement($.Z,{placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement(c.Z.Item,{label:"\u8D1F\u8D23\u4EBA",name:"director",rules:[{whitespace:!0}]},t.createElement($.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{required:!0},{validator:he.tH}]},t.createElement($.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u6709\u6548\u671F",name:"validBefore"},t.createElement(ie.Z,null)),t.createElement("div",{className:ge()(G().rowWrap,G().description)},t.createElement(c.Z.Item,(0,q.Z)({label:"\u63CF\u8FF0",name:"description",rules:[{whitespace:!0}]},Ce),t.createElement($.Z,{placeholder:"\u8BF7\u8F93\u5165"}))))))},Ie=e(3911),Fe=e(78863),Ae=e.n(Fe),Se=e(96486),be=e(24342),De={labelCol:{span:6},wrapperCol:{span:16}},Oe=function(a){var M=a.visible,p=a.toggleVisible,n=a.formData,F=a.loading,m=a.reload,x=c.Z.useForm(),L=(0,Y.Z)(x,1),r=L[0],g=(0,ae.Z)(),d=g.tip,z=g.setTip,f=n.directorRoleId,T=(0,ne.tT)("resourceData"),i=T.resourceList,A=(0,W.QT)(function(o){return API.authorization.resource.listUserResourceData.fetch({clientKey:h.OW.clientId,roleId:o})},{manual:!0,onSuccess:function(s){var v=[];s.forEach(function(S){var U=S.id,C=S.privilegeList,k=C===void 0?[]:C;v.push(U),(0,_.Z)(k)||k.forEach(function(xe){v.push(xe.id)})}),r.setFieldsValue({resourceIds:v})}}),R=A.run;(0,t.useEffect)(function(){M&&R(f)},[M]),(0,t.useEffect)(function(){return(0,_.Z)(n)||r.setFieldsValue(n),function(){r.resetFields()}},[n]);var j=function(){p(),r.resetFields()},N=function(s){var v=s.resourceIds,S=v===void 0?[]:v,U=(0,Ie.Z)(s,["resourceIds"]);z("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var C=(0,ee.HO)((0,O.Z)((0,O.Z)({},U),{},{clientKey:h.OW.clientId,id:f,resourceIds:S.filter(function(k){return(0,Se.isNumber)(k)})}));return API.platform.sysRole.resourceSave.fetch(C)},E=(0,W.QT)(N,{manual:!0,onSuccess:function(){I.default.success("\u4FDD\u5B58\u6210\u529F"),r.resetFields(),p(),m==null||m()}}),y=E.run,u=E.loading,l=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"description",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u6807\u8BC6",dataIndex:"resourceKey",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"type",align:"left",copyable:!1,valueType:"text",render:function(s){return s===h.o4.\u8DEF\u7531\u7EA7\u8D44\u6E90?"\u8DEF\u7531\u7EA7\u8D44\u6E90":"\u9875\u9762\u7EA7\u8D44\u6E90"}}];return t.createElement(b.Z,{centered:!0,visible:M,forceRender:!0,maskClosable:!1,title:"\u4F01\u4E1A\u6388\u6743",okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return r.submit()},onCancel:j,confirmLoading:u},t.createElement(te.Z,{spinning:F&&u,tip:d},t.createElement(c.Z,(0,q.Z)({form:r,onFinish:y},De,{className:Ae().formWrap}),t.createElement(c.Z.Item,{label:"\u6743\u9650\u5217\u8868",name:"resourceIds",noStyle:!0},t.createElement(be.Z,{search:!1,rowKey:"id",columns:l,dataSource:i})))))},re=e(89193),Me=function(){var a=(0,t.useRef)(),M=(0,re.x)({visible:!1,formData:{},loading:!1}),p=(0,Y.Z)(M,2),n=p[0],F=p[1],m=(0,re.x)({visible:!1,formData:{},loading:!1}),x=(0,Y.Z)(m,2),L=x[0],r=x[1],g=a.current||{},d=g.reload,z=(0,W.QT)(API.platform.sysOrg.updateStatus.fetch,{manual:!0,onSuccess:function(){I.default.success("\u64CD\u4F5C\u6210\u529F"),d==null||d()}}),f=z.run,T=(0,W.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){I.default.success("\u5220\u9664\u6210\u529F"),d==null||d()}}),i=T.run,A=function(){var y=(0,V.Z)(D().mark(function u(l){var o,s,v,S;return D().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,API.platform.sysOrg.pageList.fetch((0,ee.HO)((0,O.Z)((0,O.Z)({},l),{},{page:(l==null?void 0:l.current)||h.ii.page,pageSize:(l==null?void 0:l.pageSize)||h.ii.pageSize})));case 2:return o=C.sent,s=o.list,v=o.page,S=o.total,C.abrupt("return",{data:s||[],page:v,success:!0,total:S});case 7:case"end":return C.stop()}},u)}));return function(l){return y.apply(this,arguments)}}(),R=function(u){F(function(l){l.visible=!0,l.loading=!0,l.formData=u})},j=function(){F(function(u){u.visible=!0,u.formData={}})},N=function(u){r(function(l){l.visible=!0,l.loading=!0,l.formData=u})},E=function(u){var l={edit:F,auth:r};l[u](function(o){o.visible=!1,o.loading=!1,o.formData={}})};return{actionRef:a,reload:d,editModalConfig:n,setEditModalConfig:F,authModalConfig:L,setAuthModalConfig:r,handleDelete:i,fetchList:A,handleCompanyEdit:R,handleUpdateStatus:f,handleCompanyAdd:j,handleAuthorize:N,handleModalHide:E}},Te=function(){var a=Me(),M=a.actionRef,p=a.reload,n=a.editModalConfig,F=a.fetchList,m=a.handleUpdateStatus,x=a.handleCompanyAdd,L=a.handleCompanyEdit,r=a.handleModalHide,g=a.authModalConfig,d=a.handleAuthorize,z=[{title:"\u4F01\u4E1A\u7F16\u7801",dataIndex:"orgCode",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA",dataIndex:"director",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,oe.BJ)(h.w6)},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"date",hideInSearch:!1,hideInTable:!0},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(T,i){return t.createElement(ue.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return L(i)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return d(i)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return b.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return i.id&&m({status:h.w6.\u7981\u7528,id:"".concat(i.id)})}})},hidden:h.w6.\u7981\u7528===+i.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var A=(0,V.Z)(D().mark(function j(){return D().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",i.id&&m({status:h.w6.\u6B63\u5E38,id:"".concat(i.id)}));case 1:case"end":return E.stop()}},j)}));function R(){return A.apply(this,arguments)}return R}(),hidden:h.w6.\u7981\u7528!==+i.status}]})}}];return t.createElement(t.Fragment,null,t.createElement(Q.ZP,{style:{padding:"18px 22px"},actionRef:M,request:F,onRequestError:function(T){console.error(T.message),I.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(T.message))},columns:z,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u4F01\u4E1A\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(P.Z,{onClick:x,key:"add",type:"primary"},t.createElement(w.Z,null),"\u65B0\u5EFA")]}}),t.createElement(Ze,{visible:n.visible,formData:n.formData,loading:n.loading,toggleVisible:function(){return r("edit")},reload:p}),t.createElement(Oe,{visible:g.visible,formData:g.formData,loading:g.loading,toggleVisible:function(){return r("auth")},reload:p}))}}}]);
