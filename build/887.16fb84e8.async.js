(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[887],{84664:function(Q){Q.exports={formWrap:"formWrap___276Lb",rowWrap:"rowWrap___1Q2qE",listWrap:"listWrap___2GzdK",userName:"userName___3K3PK"}},55632:function(Q){Q.exports={treeWrap:"treeWrap___LOi_-",cover:"cover___3a6dl"}},31567:function(Q,P,e){"use strict";var H=e(19597),D=e(2291),G=e(37482),f=e(3810),q=e(44742),u=e(67294),t=e(48786);P.Z=function(y){var R=y.buttons,l=y.maxNumber,n=l===void 0?2:l,a=y.className,k=y.style,p=R.filter(function(r){return!r.hidden}),ce=p.length,ee=function(Z){var E=Z,I=[];return Z.length>n&&(E=Z.slice(0,n-1),I=Z.slice(n-1)),[E,I]},J=(0,u.useMemo)(function(){return ee(p)},[p]),x=(0,q.Z)(J,2),K=x[0],se=x[1];return u.createElement("div",{className:a,style:k},K.map(function(r,Z){var E=r.name,I=r.key,Y=r.onClick,me=r.path,b=u.createElement("a",{style:{marginRight:18},key:I,onClick:me?function(){return t.m8.push(me)}:Y},E);return Z!==ce-1?u.createElement(u.Fragment,{key:I},b):b}),se.length>0&&u.createElement(D.Z,{overlay:u.createElement(f.Z,null,se.map(function(r){return u.createElement(f.Z.Item,{onClick:r.path?function(){return t.m8.push(r.path)}:function(){var Z;return(Z=r.onClick)===null||Z===void 0?void 0:Z.call(r)}},r.name)}))},u.createElement("a",null,"\u66F4\u591A")))}},57044:function(Q,P,e){"use strict";var H=e(87753),D=e(98570),G=e(67294),f=e(96486),q=e.n(f);P.Z=function(u){var t=u.value,y=t===void 0?[]:t,R=u.onChange,l=u.treeData,n=l===void 0?[]:l,a=function(p,ce){var ee=ce||{},J=ee.node,x=ee.checked,K=J||{},se=K.children,r=se===void 0?[]:se,Z=p.checked,E=function I(Y){if(!(!Y||(0,f.isEmpty)(Y))){var me=Y.map(function(b){return b.key});x||(Z=Z.filter(function(b){return!me.includes(b)})),Y.forEach(function(b){(0,f.isEmpty)(b.children)||I(b.children)})}};E(r),R==null||R(Z)};return G.createElement(D.Z,{checkable:!0,defaultExpandAll:!0,onCheck:a,checkedKeys:y,treeData:n,checkStrictly:!0})}},31261:function(Q,P,e){"use strict";e.d(P,{Z:function(){return G}});var H=e(67294),D=e(48786);function G(f){var q=(0,D.tT)("@@initialState"),u=q.initialState,t=u||{},y=t.privileges,R=y===void 0?[]:y,l=(0,H.useMemo)(function(){return R.some(function(n){return n.resourceKey===f})},[R,f]);return{showCompanySelect:l}}},84850:function(Q,P,e){"use strict";e.d(P,{Z:function(){return G}});var H=e(44742),D=e(67294);function G(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,q=(0,D.useState)(!1),u=(0,H.Z)(q,2),t=u[0],y=u[1],R=(0,D.useState)(""),l=(0,H.Z)(R,2),n=l[0],a=l[1];return(0,D.useEffect)(function(){y(f)},[]),{spinning:t,setSpinning:y,tip:n,setTip:a}}},76887:function(Q,P,e){"use strict";e.r(P),e.d(P,{default:function(){return Xe}});var H=e(13753),D=e(48429),G=e(14643),f=e(92909),q=e(97140),u=e(93228),t=e(67294),y=e(21191),R=e(49101),l=e(31567),n=e(26780),a=e(46567),k=e(58210),p=e(87240),ce=e(37092),ee=e(91911),J=e(13378),x=e(68137),K=e(50532),se=e(3911),r=e(56361),Z=e(67604),E=e(66498),I=e(44742),Y=e(46368),me=e(46391),b=e(47376),fe=e(66827),Ze=e(84850),pe=e(48786),he=e(66594),Fe=e(57044),Le=e(55632),Se=e.n(Le),Me=e(50189),De=function(i){var d=[];return i?(Object.keys(i).forEach(function(v){d.push.apply(d,(0,Me.Z)(i[v].map(function(o){return o.id})))}),d):[]},Re=e(27870),xe={labelCol:{span:3},wrapperCol:{span:20}},be={labelCol:{span:3},wrapperCol:{span:10}},We=function(i){var d=i.visible,v=i.toggleVisible,o=i.formData,te=i.loading,U=i.reload,ie=E.Z.useForm(),W=(0,I.Z)(ie,1),h=W[0],X=(0,Ze.Z)(),ne=X.tip,_=X.setTip,w=o.id,m=(0,pe.tT)("@@initialState"),ae=m.initialState,re=ae||{},O=re.authResourceData,F=re.userInfo,L=F||{},N=L.orgCode,$=(0,t.useState)(!1),z=(0,I.Z)($,2),oe=z[0],C=z[1];(0,t.useEffect)(function(){if(!(0,Y.Z)(o)){var M=o||{},j=M.resourceMap,T=j===void 0?{}:j,ve=De(T);h.setFieldsValue((0,r.Z)((0,r.Z)({},o),{},{resourceIds:ve,modalResourceIds:ve}))}return function(){h.resetFields()}},[o]);var s=function(){v(),h.resetFields()},c=function(j){var T=j.resourceIds,ve=T===void 0?[]:T,Ae=j.modalResourceIds,Ce=(0,se.Z)(j,["resourceIds","modalResourceIds"]);_("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var ge=(0,Re.HO)((0,r.Z)((0,r.Z)({},Ce),{},{clientKey:he.OW.clientId,id:w,businessValue:N,resourceIds:ve.filter(function(ye){return(0,me.Z)(ye)})}));return API.authorization.resourceRole.resourceSave.fetch(ge)},g=(0,fe.QT)(c,{manual:!0,onSuccess:function(){f.default.success("\u4FDD\u5B58\u6210\u529F"),h.resetFields(),v(),U==null||U()}}),V=g.run,B=g.loading;return t.createElement(E.Z,(0,J.Z)({form:h,onFinish:V},be),t.createElement(a.Z,{centered:!0,visible:d,forceRender:!0,maskClosable:!1,title:"".concat((0,b.Z)(w)?"\u65B0\u5EFA":"\u7F16\u8F91","\u89D2\u8272"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return h.submit()},onCancel:s,confirmLoading:B},t.createElement(p.Z,{spinning:te&&B,tip:ne},t.createElement(E.Z.Item,{label:"\u89D2\u8272\u540D\u79F0",name:"role",rules:[{whitespace:!0},{required:!0}]},t.createElement(K.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(E.Z.Item,(0,J.Z)({label:"\u89D2\u8272\u63CF\u8FF0",name:"comment"},xe,{rules:[{whitespace:!0}]}),t.createElement(K.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:Se().treeWrap},t.createElement("div",{className:Se().cover,onClick:function(){return C(!0)}}),t.createElement(E.Z.Item,{label:"\u62E5\u6709\u8D44\u6E90",name:"resourceIds",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u62E5\u6709\u8D44\u6E90"}]},t.createElement(ee.Z,{treeData:O,allowClear:!0,multiple:!0,placeholder:"\u8BF7\u9009\u62E9"}))))),t.createElement(a.Z,{centered:!0,visible:oe,forceRender:!0,maskClosable:!1,title:"\u62E5\u6709\u8D44\u6E90",width:412,onOk:function(){h.setFieldsValue({resourceIds:h.getFieldValue("modalResourceIds")}),C(!1)},onCancel:function(){h.setFieldsValue({modalResourceIds:h.getFieldValue("resourceIds")}),C(!1)},confirmLoading:B},t.createElement(E.Z.Item,{label:"\u62E5\u6709\u8D44\u6E90",name:"modalResourceIds",noStyle:!0},t.createElement(Fe.Z,{treeData:O}))))},Be=We,et=e(66518),Oe=e(95322),tt=e(44862),Ke=e(42091),Ue=e(3855),Ne=e(84664),Ee=e.n(Ne),Ie=e(89193),$e={page:1,pageSize:6},ze={labelCol:{span:6},wrapperCol:{span:16}},Ve=function(S){var i=S.visible,d=S.toggleVisible,v=S.formData,o=S.reload,te=S.orgId,U=(0,pe.tT)("@@initialState"),ie=U.initialState,W=ie||{},h=W.userInfo,X=h||{},ne=X.orgId,_=E.Z.useForm(),w=(0,I.Z)(_,1),m=w[0],ae=(0,Ze.Z)(),re=ae.tip,O=ae.setTip,F=v.id,L=(0,t.useState)([]),N=(0,I.Z)(L,2),$=N[0],z=N[1],oe=(0,Ie.x)($e),C=(0,I.Z)(oe,2),s=C[0],c=C[1],g=(0,fe.QT)(API.platform.sysUser.pageList.fetch,{manual:!0}),V=g.data,B=g.run,M=g.loading,j=(0,fe.QT)(API.authorization.resourceRole.resourceRoleDetailUser.fetch,{manual:!0,onSuccess:function(A){var le=A.userIdList,ue=le===void 0?[]:le;z(ue)}}),T=j.run,ve=j.loading;(0,t.useEffect)(function(){i&&(B((0,r.Z)((0,r.Z)({},s),{},{orgId:te||ne})),T({clientKey:he.OW.clientId,roleId:F}))},[te,ne,i,s]),(0,t.useEffect)(function(){return(0,Y.Z)(v)||m.setFieldsValue((0,r.Z)({},v)),function(){m.resetFields()}},[v]);var Ae=function(){d(),m.resetFields()},Ce=function(){return O("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019..."),API.authorization.resourceRole.resourceSaveAddUser.fetch({clientKey:he.OW.clientId,id:F,userIds:$.map(function(A){return+A}),resourceIds:v.resourceIds,role:v.role})},ge=(0,fe.QT)(Ce,{manual:!0,onSuccess:function(){f.default.success("\u6388\u6743\u6210\u529F"),m.resetFields(),d(),o==null||o()}}),ye=ge.run,Pe=ge.loading,_e=function(A,le){var ue=(0,Me.Z)($);A.target.checked?ue.push(+le.userId):ue=ue.filter(function(qe){return qe!==le.userId}),z(ue)},we=function(A){return t.createElement(Oe.ZP.Item,null,t.createElement(Ke.Z,{checked:$.includes(+A.userId),onChange:function(ue){return _e(ue,A)}},t.createElement("div",{className:Ee().userName},A.userName,A.phone?"(".concat(A.phone.slice(-4),")"):"")))};return t.createElement(a.Z,{centered:!0,visible:i,forceRender:!0,maskClosable:!1,title:"\u7528\u6237\u6388\u6743",okButtonProps:{htmlType:"submit"},width:442,onOk:function(){return m.submit()},onCancel:Ae,confirmLoading:Pe,wrapClassName:"auth-modal"},t.createElement(p.Z,{spinning:M&&Pe&&ve,tip:re},t.createElement(E.Z,(0,J.Z)({form:m,onFinish:ye},ze,{className:Ee().formWrap}),t.createElement(E.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"account",tooltip:{icon:t.createElement(Ue.Z,null),title:"\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00"},noStyle:!0},t.createElement(Oe.ZP,{loading:M,className:Ee().listWrap,size:"small",dataSource:V==null?void 0:V.list,pagination:(0,r.Z)((0,r.Z)({},s),{},{current:s.page,onChange:function(A){c(function(le){le.page=A})},showQuickJumper:!0}),renderItem:we})))))},je=e(68699),Qe=e(94043),Te=e.n(Qe),He=function(){var S=(0,t.useRef)(),i=(0,t.useState)(),d=(0,I.Z)(i,2),v=d[0],o=d[1],te=(0,Ie.x)({visible:!1,formData:{},loading:!1}),U=(0,I.Z)(te,2),ie=U[0],W=U[1],h=(0,Ie.x)({visible:!1,formData:{}}),X=(0,I.Z)(h,2),ne=X[0],_=X[1],w=S.current||{},m=w.reload,ae=(0,fe.QT)(API.authorization.role.update.fetch,{manual:!0,onSuccess:function(){f.default.success("\u64CD\u4F5C\u6210\u529F"),m==null||m()}}),re=ae.run,O=(0,fe.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){f.default.success("\u5220\u9664\u6210\u529F"),m==null||m()}}),F=O.run,L=function(){var C=(0,je.Z)(Te().mark(function s(c){var g,V,B,M;return Te().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,API.platform.sysRole.pageList.fetch((0,Re.HO)((0,r.Z)((0,r.Z)({},c),{},{page:(c==null?void 0:c.current)||he.ii.page,pageSize:(c==null?void 0:c.pageSize)||he.ii.pageSize})));case 2:return g=T.sent,V=g.list,B=g.page,M=g.total,T.abrupt("return",{data:V||[],page:B,success:!0,total:M});case 7:case"end":return T.stop()}},s)}));return function(c){return C.apply(this,arguments)}}(),N=function(s){W(function(c){c.visible=!0,c.loading=!0,c.formData=s})},$=function(){W(function(s){s.visible=!0,s.formData={}})},z=function(s){var c=s||{},g=c.resourceMap,V=De(g);_(function(B){B.visible=!0,B.formData=(0,r.Z)((0,r.Z)({},s),{},{resourceIds:V})})},oe=function(s){var c={edit:W,auth:_};c[s](function(g){g.visible=!1,g.loading=!1,g.formData={}})};return{orgId:v,setOrgId:o,actionRef:S,reload:m,editModalConfig:ie,setEditModalConfig:W,authModalConfig:ne,setAuthModalConfig:_,handleDisable:re,handleDelete:F,fetchList:L,handleRoleEdit:N,handleRoleAdd:$,handleAuthorize:z,handleModalHide:oe}},Ge=e(31261),nt=e(81984),ke=e(82692),Je=e(73567),Ye=function(S){var i=S.text,d=i===void 0?"":i,v=S.maxLength,o=v===void 0?50:v;return(d==null?void 0:d.length)>o?t.createElement(ke.Z,{title:d},t.createElement("span",null,Je.ZP.textEllipsis(d,o))):t.createElement("span",null,d)},Xe=function(){var S=(0,pe.tT)("company"),i=S.companyMapOptions,d=(0,Ge.Z)("auth_authority_menu_company"),v=d.showCompanySelect,o=He(),te=o.orgId,U=o.setOrgId,ie=o.actionRef,W=o.reload,h=o.editModalConfig,X=o.fetchList,ne=o.handleRoleAdd,_=o.handleRoleEdit,w=o.handleModalHide,m=o.authModalConfig,ae=o.handleAuthorize,re=[{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgCode",align:"left",copyable:!1,valueType:"text",hideInSearch:!v,hideInTable:!0,renderFormItem:function(){return t.createElement(u.Z,{allowClear:!0,options:i,onChange:function(L){return U(L)}})}},{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"role",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u89D2\u8272\u63CF\u8FF0",dataIndex:"comment",align:"left",copyable:!1,valueType:"text",hideInSearch:!0},{title:"\u62E5\u6709\u8D44\u6E90",dataIndex:"resourceList",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(F,L){var N=L||{},$=N.resourceMap,z=$===void 0?[]:$,oe=[];return Object.keys(z).forEach(function(C){z[C].forEach(function(s){oe.push(s.description)})}),t.createElement(Ye,{text:oe.join(",")})}},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(F,L){return t.createElement(l.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return _(L)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return ae(L)}}]})}}];return t.createElement(t.Fragment,null,t.createElement(y.ZP,{style:{padding:"18px 22px"},actionRef:ie,request:X,onRequestError:function(F){console.error(F.message),f.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(F.message))},columns:re,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u83DC\u5355\u6743\u9650\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(D.Z,{onClick:ne,key:"add",type:"primary"},t.createElement(R.Z,null),"\u65B0\u5EFA")]}}),t.createElement(Be,{visible:h.visible,formData:h.formData,loading:h.loading,toggleVisible:function(){return w("edit")},reload:W}),t.createElement(Ve,{visible:m.visible,formData:m.formData,toggleVisible:function(){return w("auth")},reload:W,orgId:te}))}},73567:function(Q,P,e){"use strict";var H=1,D=1,G=4;P.ZP={fillZero:function(n){return typeof n=="number"&&n>=10?n:"0".concat(n)},textEllipsis:function(n,a){return n.length>a&&a>0?"".concat(n.substring(0,a),"..."):n},getLastSubstring:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return n.substring(n.lastIndexOf(a)+a.length,n.length)},valueToString:function(n){return typeof n=="string"?n:JSON.stringify(n)},copyText:function(n){var a=document.createElement("input");document.body.appendChild(a),a.setAttribute("value",n),a.select(),document.execCommand("copy"),document.body.removeChild(a)},imgUrlToBase64:function(n,a,k){var p=document.createElement("canvas"),ce=p.getContext("2d");return new Promise(function(ee,J){var x=new Image;x.crossOrigin="Anonymous",x.onload=function(){p.width=a,p.height=k,ce.drawImage(x,0,0,a,k);var K=p.toDataURL("image/");p=null,ee(K)},x.onerror=function(K){J(K)},x.src=n})}};var f=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return n||n===0?(n/100).toFixed(a):""},q=function(n){return n*100},u=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return n?"".concat(n.slice(0,a),"****").concat(n.slice(-a)):""},t=function(n){var a=/(?<=.)./g;return n==null?void 0:n.replace(a,"*")},y=function(n){var a,k=(a=n==null?void 0:n.split("-"))!==null&&a!==void 0?a:[];return k.filter(function(p){return!!p}).length===2?n:k.join("")},R=function(n,a){return n===H&&(a===D||a===G)}}}]);
