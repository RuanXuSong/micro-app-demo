(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[335],{34950:function(W,F){"use strict";Object.defineProperty(F,"__esModule",{value:!0});var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};F.default=e},3855:function(W,F,e){"use strict";var X,z=e(95318),Y=e(20862);X={value:!0},F.Z=void 0;var A=Y(e(67294)),K=z(e(34950)),$=z(e(92074)),O=function(t,G){return A.createElement($.default,Object.assign({},t,{ref:G,icon:K.default}))};O.displayName="ExclamationCircleOutlined";var Q=A.forwardRef(O);F.Z=Q},78863:function(W){W.exports={formWrap:"formWrap___3eS8c",rowWrap:"rowWrap___3VEOz",description:"description___bi6uK"}},79920:function(W){W.exports={formWrap:"formWrap___19ekr",rowWrap:"rowWrap___1jzhp",description:"description___2a_68"}},24342:function(W,F,e){"use strict";var X=e(13378),z=e(56361),Y=e(3911),A=e(67294),K=e(87542);F.Z=function($){var O=$.value,Q=O===void 0?[]:O,M=$.onChange,t=(0,Y.Z)($,["value","onChange"]),G={selectedRowKeys:Q,onChange:function(q){M==null||M(q)}};return A.createElement(K.ZP,(0,X.Z)({rowSelection:(0,z.Z)((0,z.Z)({},G),{},{checkStrictly:!0})},t))}},34335:function(W,F,e){"use strict";e.r(F),e.d(F,{default:function(){return Re}});var X=e(13753),z=e(48429),Y=e(14643),A=e(92909),K=e(68699),$=e(26780),O=e(46567),Q=e(94043),M=e.n(Q),t=e(67294),G=e(87542),p=e(66594),q=e(49101),ue=e(96689),se=e(31567),Be=e(58210),ae=e(87240),_=e(13378),Pe=e(74393),de=e(88995),Le=e(68137),N=e(50532),T=e(56361),We=e(67604),c=e(66498),k=e(44742),ee=e(46368),ce=e(47376),j=e(66827),ne=e(84850),me=e(3678),fe=e(95951),ve=e(32615),he=e(3855),pe=e(79920),J=e.n(pe),ge=e(42348),Ee=e(35510),ye=e.n(Ee),Ce=e(56051),le=e.n(Ce),te=e(27870),re=e(48786),Ze=function(m){return m&&m<le()().endOf("day")},oe={labelCol:{span:8},wrapperCol:{span:14}},Ie={labelCol:{span:4},wrapperCol:{span:19}},Fe=function(a){var m=a.visible,g=a.toggleVisible,n=a.formData,f=a.reload,b=c.Z.useForm(),B=(0,k.Z)(b,1),v=B[0],o=(0,ne.Z)(),S=o.tip,d=o.setTip,P=n.id,E=(0,re.tT)("company"),x=E.reloadCompanyData;(0,t.useEffect)(function(){return(0,ee.Z)(n)||v.setFieldsValue((0,T.Z)((0,T.Z)({},n),{},{validBefore:n.validBefore?le()(n.validBefore):null,logo:n!=null&&n.logo?[{uid:"1",name:"logo",status:"done",url:n==null?void 0:n.logo,size:0}]:[]})),function(){v.resetFields()}},[n]);var u=function(){g(),v.resetFields()},y=function(){A.default.success("\u4FDD\u5B58\u6210\u529F"),v.resetFields(),g(),f==null||f(),x()},R=(0,j.QT)(API.platform.sysOrg.update.fetch,{onSuccess:y,manual:!0}),U=R.run,H=R.loading,h=(0,j.QT)(API.platform.sysOrg.save.fetch,{onSuccess:y,manual:!0}),C=h.run,i=h.loading,l=function(s){d("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var V=(0,te.HO)((0,T.Z)((0,T.Z)((0,T.Z)({},n),s),{},{logo:s.logo.map(function(w){return w.url||w.response.data.url})[0]}));return P?U(V):C(V)},r=(0,j.QT)(l,{manual:!0}),Z=r.run,I=r.loading,D=I||H||i;return t.createElement(O.Z,{centered:!0,visible:m,forceRender:!0,maskClosable:!1,title:"".concat((0,ce.Z)(P)?"\u65B0\u5EFA":"\u7F16\u8F91","\u4F01\u4E1A"),okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return v.submit()},onCancel:u,confirmLoading:D},t.createElement(ae.Z,{spinning:D,tip:S},t.createElement(c.Z,(0,_.Z)({form:v,onFinish:Z},oe,{className:J().formWrap}),t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u7F16\u7801",name:"orgCode",tooltip:{icon:t.createElement(he.Z,null),title:`\u4F01\u4E1A\u7F16\u7801\u5C06\u4F5C\u4E3A\u4F01\u4E1A\u4E0B\u6240\u6709\u8D26\u53F7\u540E\u7F00
\u9700\u8981\u8F93\u516520\u4F4D\u4EE5\u5185\u5B57\u6BCD\uFF0C\u533A\u5206\u5927\u5C0F\u5199`},rules:[{whitespace:!0},{required:!0}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u540D\u79F0",name:"orgName",rules:[{whitespace:!0}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement("div",{className:J().rowWrap},t.createElement(me.Z,{formItemProps:oe,label:"\u4F01\u4E1Alogo",name:"logo",maxCount:1,accept:fe.b1.\u56FE\u7247.join(","),uploadProps:{listType:"picture-card"},required:!0,requiredMessage:"\u8BF7\u4E0A\u4F20"},t.createElement(ve.Z,null))),t.createElement("div",{className:J().rowWrap},t.createElement(c.Z.Item,{label:"\u4F01\u4E1A\u4EE3\u7801",name:"enterpriseCode",rules:[{whitespace:!0}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"}))),t.createElement(c.Z.Item,{label:"\u8D1F\u8D23\u4EBA",name:"director",rules:[{whitespace:!0},{required:!0}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",name:"phone",rules:[{whitespace:!0},{required:!0},{validator:ge.tH}]},t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"})),t.createElement(c.Z.Item,{label:"\u6709\u6548\u671F",name:"validBefore",rules:[{required:!0}]},t.createElement(de.Z,{disabledDate:Ze})),t.createElement("div",{className:ye()(J().rowWrap,J().description)},t.createElement(c.Z.Item,(0,_.Z)({label:"\u63CF\u8FF0",name:"description",rules:[{whitespace:!0},{required:!0}]},Ie),t.createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165"}))))))},Ae=e(3911),be=e(78863),Se=e.n(be),De=e(96486),Oe=e(24342),Me={labelCol:{span:6},wrapperCol:{span:16}},Te=function(a){var m=a.visible,g=a.toggleVisible,n=a.formData,f=a.loading,b=a.reload,B=c.Z.useForm(),v=(0,k.Z)(B,1),o=v[0],S=(0,ne.Z)(),d=S.tip,P=S.setTip,E=n.directorRoleId,x=(0,re.tT)("resourceData"),u=x.resourceList,y=(0,j.QT)(function(r){return API.authorization.resource.listUserResourceData.fetch({clientKey:p.OW.clientId,roleId:r})},{manual:!0,onSuccess:function(Z){var I=[];Z.forEach(function(D){var L=D.id,s=D.privilegeList,V=s===void 0?[]:s;I.push(L),(0,ee.Z)(V)||V.forEach(function(w){I.push(w.id)})}),o.setFieldsValue({resourceIds:I})}}),R=y.run;(0,t.useEffect)(function(){m&&R(E)},[m]),(0,t.useEffect)(function(){return(0,ee.Z)(n)||o.setFieldsValue(n),function(){o.resetFields()}},[n]);var U=function(){g(),o.resetFields()},H=function(Z){var I=Z.resourceIds,D=I===void 0?[]:I,L=(0,Ae.Z)(Z,["resourceIds"]);P("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var s=(0,te.HO)((0,T.Z)((0,T.Z)({},L),{},{clientKey:p.OW.clientId,id:E,resourceIds:D.filter(function(V){return(0,De.isNumber)(V)})}));return API.platform.sysRole.resourceSave.fetch(s)},h=(0,j.QT)(H,{manual:!0,onSuccess:function(){A.default.success("\u4FDD\u5B58\u6210\u529F"),o.resetFields(),g(),b==null||b()}}),C=h.run,i=h.loading,l=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"description",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u6807\u8BC6",dataIndex:"resourceKey",align:"left",copyable:!1,valueType:"text"},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"type",align:"left",copyable:!1,valueType:"text",render:function(Z){return Z===p.o4.\u8DEF\u7531\u7EA7\u8D44\u6E90?"\u8DEF\u7531\u7EA7\u8D44\u6E90":"\u9875\u9762\u7EA7\u8D44\u6E90"}}];return t.createElement(O.Z,{centered:!0,visible:m,forceRender:!0,maskClosable:!1,title:"\u4F01\u4E1A\u6388\u6743",okButtonProps:{htmlType:"submit"},width:800,onOk:function(){return o.submit()},onCancel:U,confirmLoading:i},t.createElement(ae.Z,{spinning:f&&i,tip:d},t.createElement(c.Z,(0,_.Z)({form:o,onFinish:C},Me,{className:Se().formWrap}),t.createElement(c.Z.Item,{label:"\u6743\u9650\u5217\u8868",name:"resourceIds",noStyle:!0},t.createElement(Oe.Z,{search:!1,rowKey:"id",columns:l,dataSource:u})))))},ie=e(89193),xe=function(){var a=(0,t.useRef)(),m=(0,ie.x)({visible:!1,formData:{},loading:!1}),g=(0,k.Z)(m,2),n=g[0],f=g[1],b=(0,ie.x)({visible:!1,formData:{},loading:!1}),B=(0,k.Z)(b,2),v=B[0],o=B[1],S=a.current||{},d=S.reload,P=(0,j.QT)(API.platform.sysOrg.updateStatus.fetch,{manual:!0,onSuccess:function(){A.default.success("\u64CD\u4F5C\u6210\u529F"),d==null||d()}}),E=P.run,x=(0,j.QT)(API.authorization.resourceRole.resourceDelete.fetch,{manual:!0,onSuccess:function(){A.default.success("\u5220\u9664\u6210\u529F"),d==null||d()}}),u=x.run,y=function(){var C=(0,K.Z)(M().mark(function i(l){var r,Z,I,D;return M().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,API.platform.sysOrg.pageList.fetch((0,te.HO)((0,T.Z)((0,T.Z)({},l),{},{page:(l==null?void 0:l.current)||p.ii.page,pageSize:(l==null?void 0:l.pageSize)||p.ii.pageSize})));case 2:return r=s.sent,Z=r.list,I=r.page,D=r.total,s.abrupt("return",{data:Z||[],page:I,success:!0,total:D});case 7:case"end":return s.stop()}},i)}));return function(l){return C.apply(this,arguments)}}(),R=function(i){f(function(l){l.visible=!0,l.loading=!0,l.formData=i})},U=function(){f(function(i){i.visible=!0,i.formData={}})},H=function(i){o(function(l){l.visible=!0,l.loading=!0,l.formData=i})},h=function(i){var l={edit:f,auth:o};l[i](function(r){r.visible=!1,r.loading=!1,r.formData={}})};return{actionRef:a,reload:d,editModalConfig:n,setEditModalConfig:f,authModalConfig:v,setAuthModalConfig:o,handleDelete:u,fetchList:y,handleCompanyEdit:R,handleUpdateStatus:E,handleCompanyAdd:U,handleAuthorize:H,handleModalHide:h}},Re=function(){var a=xe(),m=a.actionRef,g=a.reload,n=a.editModalConfig,f=a.fetchList,b=a.handleUpdateStatus,B=a.handleCompanyAdd,v=a.handleCompanyEdit,o=a.handleModalHide,S=a.authModalConfig,d=a.handleAuthorize,P=[{title:"\u4F01\u4E1A\u7F16\u7801",dataIndex:"orgCode",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u4F01\u4E1A\u540D\u79F0",dataIndex:"orgName",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA",dataIndex:"director",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u8D1F\u8D23\u4EBA\u624B\u673A\u53F7",dataIndex:"phone",align:"left",copyable:!1,valueType:"text",hideInSearch:!1},{title:"\u72B6\u6001",dataIndex:"status",align:"left",copyable:!1,valueType:"text",hideInSearch:!1,valueEnum:(0,ue.BJ)(p.w6)},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"date",hideInSearch:!1,hideInTable:!0},{title:"\u6709\u6548\u671F",dataIndex:"validBefore",align:"left",copyable:!1,valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"id",align:"left",copyable:!1,valueType:"text",hideInSearch:!0,render:function(x,u){return t.createElement(se.Z,{buttons:[{name:"\u7F16\u8F91",key:"edit",onClick:function(){return v(u)}},{name:"\u6388\u6743",key:"authorize",onClick:function(){return d(u)}},{name:"\u7981\u7528",key:"disable",onClick:function(){return O.Z.confirm({title:"\u786E\u8BA4\u7981\u7528\uFF1F",onOk:function(){return u.id&&b({status:p.w6.\u7981\u7528,id:"".concat(u.id)})}})},hidden:p.w6.\u7981\u7528===+u.status},{name:"\u542F\u7528",key:"enable",onClick:function(){var y=(0,K.Z)(M().mark(function U(){return M().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",u.id&&b({status:p.w6.\u6B63\u5E38,id:"".concat(u.id)}));case 1:case"end":return h.stop()}},U)}));function R(){return y.apply(this,arguments)}return R}(),hidden:p.w6.\u7981\u7528!==+u.status}]})}}];return t.createElement(t.Fragment,null,t.createElement(G.ZP,{style:{padding:"18px 22px"},actionRef:m,request:f,onRequestError:function(x){console.error(x.message),A.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25,".concat(x.message))},columns:P,bordered:!0,rowKey:"id",pagination:{size:"default"},dateFormatter:"string",headerTitle:"\u4F01\u4E1A\u5217\u8868",tableAlertRender:!1,toolBarRender:function(){return[t.createElement(z.Z,{onClick:B,key:"add",type:"primary"},t.createElement(q.Z,null),"\u65B0\u5EFA")]}}),t.createElement(Fe,{visible:n.visible,formData:n.formData,toggleVisible:function(){return o("edit")},reload:g}),t.createElement(Te,{visible:S.visible,formData:S.formData,loading:S.loading,toggleVisible:function(){return o("auth")},reload:g}))}}}]);
