(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[67],{81186:function(x){x.exports={container:"container___rQUpQ",content:"content___EfHLm",title:"title___2UjJD",infoWrap:"infoWrap___1m2u0",avatarWrap:"avatarWrap___1D0Gv",submitWrap:"submitWrap___31jW9",editBtn:"editBtn___wf9nY"}},84850:function(x,F,r){"use strict";r.d(F,{Z:function(){return S}});var g=r(44742),f=r(67294);function S(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=(0,f.useState)(!1),N=(0,g.Z)(p,2),I=N[0],C=N[1],d=(0,f.useState)(""),s=(0,g.Z)(d,2),o=s[0],a=s[1];return(0,f.useEffect)(function(){C(T)},[]),{spinning:I,setSpinning:C,tip:o,setTip:a}}},29067:function(x,F,r){"use strict";r.r(F),r.d(F,{default:function(){return u}});var g=r(58210),f=r(87240),S=r(83557),T=r(80148),p=r(13378),N=r(13753),I=r(48429),C=r(67604),d=r(66498),s=r(68137),o=r(50532),a=r(67294),H=r(81186),h=r.n(H),Z=r(12049),W=r(48786),se=r(66594),ge=r(26780),le=r(46567),K=r(14643),D=r(92909),V=r(3911),L=r(56361),M=r(44742),J=r(46368),$=r(66827),X=r(84850),_=r(42348),k={labelCol:{span:6},wrapperCol:{span:18}},q=function(e){var t=e.visible,n=e.toggleVisible,i=e.formData,c=e.loading,m=d.Z.useForm(),v=(0,M.Z)(m,1),l=v[0],P=(0,X.Z)(),B=P.tip,z=P.setTip,A=(0,a.useState)(),b=(0,M.Z)(A,2),Q=b[0],Y=b[1];(0,a.useEffect)(function(){if(!(0,J.Z)(i)){var y=i.roleList||[];l.setFieldsValue((0,L.Z)((0,L.Z)({},i),{},{roleList:y.length>0?y[0].roleId:null}))}return function(){l.resetFields()}},[i]);var ee=function(){n(),l.resetFields()},te=function(j){z("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var fe=j.confirmPassword,re=(0,V.Z)(j,["confirmPassword"]);return API.platform.sysUser.updatePassword.fetch(re)},w=(0,$.QT)(te,{manual:!0,onSuccess:function(){D.default.success("\u4FEE\u6539\u6210\u529F"),l.resetFields(),n()}}),ne=w.run,R=w.loading;return a.createElement(le.Z,{centered:!0,visible:t,forceRender:!0,maskClosable:!1,title:"\u5BC6\u7801\u4FEE\u6539",okButtonProps:{htmlType:"submit"},width:422,onOk:function(){return l.submit()},onCancel:ee,confirmLoading:R},a.createElement(f.Z,{spinning:c&&R,tip:B},a.createElement(d.Z,(0,p.Z)({form:l,onFinish:ne},k),a.createElement(d.Z.Item,{label:"\u65E7\u5BC6\u7801",name:"oldPwd",rules:[{whitespace:!0},{required:!0}]},a.createElement(o.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165"})),a.createElement(d.Z.Item,{label:"\u65B0\u5BC6\u7801",name:"newPwd",rules:[{whitespace:!0},{required:!0}]},a.createElement(o.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165",onChange:function(j){return Y(j.target.value)}})),a.createElement(d.Z.Item,{label:"\u786E\u8BA4\u65B0\u5BC6\u7801",name:"confirmPassword",rules:[{whitespace:!0},{required:!0},{validator:(0,_.ZG)(Q)}]},a.createElement(o.Z,{type:"password",placeholder:"\u8BF7\u8F93\u5165"})))))},G=r(89193),de=function(e){var t=e.currentUser,n=e.dispatch,i=d.Z.useForm(),c=(0,M.Z)(i,1),m=c[0],v=(0,G.x)({visible:!1,formData:{},loading:!1}),l=(0,M.Z)(v,2),P=l[0],B=l[1],z=(0,G.x)({visible:!1,formData:{},loading:!1}),A=(0,M.Z)(z,2),b=A[0],Q=A[1],Y=(0,X.Z)(),ee=Y.tip,te=Y.setTip,w=function(){return n({type:"user/fetchCurrent"})};(0,a.useEffect)(function(){var U=t.avatar,E=(0,V.Z)(t,["avatar"]);m.setFieldsValue((0,L.Z)((0,L.Z)({},E),{},{avatar:U?[{uid:"1",name:"\u5934\u50CF",status:"done",url:U,size:0}]:[]}))},[]);var ne=function(E){te("\u6570\u636E\u4FDD\u5B58\u4E2D\uFF0C\u8BF7\u7A0D\u5019...");var ve=E.avatar,O=(0,V.Z)(E,["avatar"]);if(E.avatar){var ae,ie,ue,oe;O.avatar=(ae=E.avatar)===null||ae===void 0||(ie=ae.file)===null||ie===void 0||(ue=ie.response)===null||ue===void 0||(oe=ue.data)===null||oe===void 0?void 0:oe.url}return API.platform.sysUser.update.fetch(O)},R=(0,$.QT)(ne,{manual:!0,onSuccess:function(){D.default.success("\u4FDD\u5B58\u6210\u529F"),w==null||w()}}),y=R.run,j=R.loading,fe=function(){B(function(E){E.visible=!0,E.formData={id:m.getFieldValue("id")}})},re=function(E){var ve={edit:B,auth:Q};ve[E](function(O){O.visible=!1,O.loading=!1,O.formData={}})};return{tip:ee,form:m,submitting:j,handleFinish:y,editModalConfig:P,setEditModalConfig:B,authModalConfig:b,setAuthModalConfig:Q,handlePasswordEdit:fe,handleModalHide:re}},ce={labelCol:{span:4},wrapperCol:{span:18}},me=function(t){var n=de(t),i=n.form,c=n.tip,m=n.submitting,v=n.handleFinish,l=n.editModalConfig,P=n.handlePasswordEdit,B=n.handleModalHide;return a.createElement("div",{className:h().container},a.createElement("div",{className:h().content},a.createElement(f.Z,{spinning:m,tip:c},a.createElement(d.Z,(0,p.Z)({form:i},ce,{onFinish:v}),a.createElement("div",{className:h().title},"\u4E2A\u4EBA\u8D44\u6599"),a.createElement("div",{className:h().infoWrap},a.createElement("div",{className:h().avatarWrap},a.createElement(d.Z.Item,{label:"id",name:"id",hidden:!0,rules:[{whitespace:!0}]},a.createElement(o.Z,{placeholder:"\u8BF7\u8F93\u5165"})),a.createElement(d.Z.Item,{label:"\u5934\u50CF",name:"avatar",valuePropName:"fileList",getValueFromEvent:Z.vE,getValueProps:function(A){var b=A!=null?A:[];return{fileList:Array.isArray(b)?b:[{url:b}]}}},a.createElement(T.Z,(0,p.Z)({},(0,Z.Ix)(),{maxCount:1,accept:Z.b1.\u56FE\u7247.join(","),multiple:!1,listType:"picture-card",defaultFileList:[{uid:"1",name:"\u9ED8\u8BA4\u5934\u50CF",status:"done",response:"\u7F51\u7EDC\u8BF7\u6C42\u5931\u8D25",url:se.q$}],showUploadList:{showRemoveIcon:!1}}),a.createElement(I.Z,{type:"primary"},"\u66F4\u6362")))),a.createElement(d.Z.Item,{label:"\u8D26\u53F7\u540D\u79F0",name:"userName",rules:[{whitespace:!0}]},a.createElement(o.Z,{placeholder:"\u8BF7\u8F93\u5165"})),a.createElement(d.Z.Item,{label:"\u8D26\u53F7\u5BC6\u7801",name:"password",rules:[{whitespace:!0}]},a.createElement(I.Z,{className:h().editBtn,type:"link",onClick:P},"\u4FEE\u6539\u5BC6\u7801")),a.createElement("div",{className:h().submitWrap},a.createElement(I.Z,{type:"primary",htmlType:"submit",className:h().submitBtn},"\u4FDD\u5B58")))))),a.createElement(q,{visible:l.visible,formData:l.formData,loading:l.loading,toggleVisible:function(){return B("edit")}}))},u=(0,W.$j)(function(e){var t=e.user;return{currentUser:t.currentUser}})(me)},4137:function(x,F,r){"use strict";r.d(F,{Mn:function(){return g},Jh:function(){return S}});var g=function(s){var o=/^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|19[0-9]|14[57])[0-9]{8}$/;return o.test(s)},f=function(s){var o=/^([0-9]{3,4}-)?[0-9]{7,8}$/;return o.test(s)},S=function(s){var o=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;return o.test(s)},T=function(s){var o=/(^([0-9]{1,})(.[0-9]+)?)$/;return o.test(s)},p=function(s){var o=/\d/;return o.test(s)},N=function(s){return(""+s).substring(1,(""+s).length-1)},I=function(s){var o=/^(-|\+)?\d+(\.\d+)?$/;return o.test(""+s)},C={isPhone:g,isTelephone:f,isEmail:S,isNumber:T,containNumbers:p}},12049:function(x,F,r){"use strict";r.d(F,{S4:function(){return h},mf:function(){return W},b1:function(){return K},o$:function(){return X},jB:function(){return G},Ix:function(){return M},vE:function(){return J}});var g=r(99463),f=1,S=1,T=4,p={fillZero:function(e){return typeof e=="number"&&e>=10?e:"0".concat(e)},textEllipsis:function(e,t){return e.length>t&&t>0?"".concat(e.substring(0,t),"..."):e},getLastSubstring:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.substring(e.lastIndexOf(t)+t.length,e.length)},valueToString:function(e){return typeof e=="string"?e:JSON.stringify(e)},copyText:function(e){var t=document.createElement("input");document.body.appendChild(t),t.setAttribute("value",e),t.select(),document.execCommand("copy"),document.body.removeChild(t)},imgUrlToBase64:function(e,t,n){var i=document.createElement("canvas"),c=i.getContext("2d");return new Promise(function(m,v){var l=new Image;l.crossOrigin="Anonymous",l.onload=function(){i.width=t,i.height=n,c.drawImage(l,0,0,t,n);var P=i.toDataURL("image/");i=null,m(P)},l.onerror=function(P){v(P)},l.src=e})}},N=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return e||e===0?(e/100).toFixed(t):""},I=function(e){return e*100},C=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return e?"".concat(e.slice(0,t),"****").concat(e.slice(-t)):""},d=function(e){var t=/(?<=.)./g;return e==null?void 0:e.replace(t,"*")},s=function(e){var t,n=(t=e==null?void 0:e.split("-"))!==null&&t!==void 0?t:[];return n.filter(function(i){return!!i}).length===2?e:n.join("")},o=function(e,t){return e===f&&(t===S||t===T)},a="http://object-service.dev.thundersdata.com",H=Object.freeze({maxSize:_,accept:k,maxCount:q}),h=10,Z=1024,W=50*Z,se=500*Z,ge=200,le=200,K={\u56FE\u7247:[".jpg",".jpeg",".gif",".png",".bmp"],\u538B\u7F29\u5305:[".rar",".zip"],\u6587\u6863:[".doc",".docx",".pdf"],\u8868\u683C:[".xls",".xlsx"],\u89C6\u9891:[".avi",".wmv",".mpg",".mpeg",".mov",".mp4",".rm",".ram"]},D=function(e){var t=/^[0-9]+$/;return t.test(""+e)?"".concat(a,"/file/download?fileId=").concat(e,"&access_token=").concat(localStorage.getItem("accessToken")):"".concat(a,"/download/direct?fileId=").concat(e,"&access_token=").concat(localStorage.getItem("accessToken"))},V=function(e){var t,n,i;e.url?i=e.url:(t=e.response)!==null&&t!==void 0&&(n=t.data)!==null&&n!==void 0&&n.fileId&&(i=D(e.response.data.fileId)),i&&window.open(i,"_blank")},L=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:K.\u56FE\u7247,n=e.name,i=e.url,c=i||n,m="."+p.getLastSubstring(c,"."),v=Array.isArray(t)?t:t.split(",");return v.includes(m)},M=function(){return{accept:".doc,.docx,.pdf,.rar,.zip,.jpg,.png,.bmp,.gif",withCredentials:!1,action:"".concat(a,"/file/uploadToPub"),data:{access_token:"223bc111017d323b00fee4cf9c59a2be"},showUploadList:{showDownloadIcon:!1},onPreview:V}},J=function(e){var t=e.fileList;return t};function $(u,e,t){try{e&&e.some(function(n){if(n.response&&!n.response.success)throw new Error("\u4E0A\u4F20\u6587\u4EF6\u5931\u8D25: "+n.response.message);return n}),t()}catch(n){t(n)}}var X=function u(e){return typeof e=="number"?e>Z?"".concat(e/1024," M"):"".concat(e," KB"):e?u(W):""};function _(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{maxSize:W},e=u.maxSize;return{validator:function(n,i,c){if(i&&i.length){var m=i.filter(function(l){return(l==null?void 0:l.size)&&l.size/Z>e});if(m.length){var v=m.map(function(l){return l.name}).join(",");c("".concat(v,"\uFF0C\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7").concat(e>Z?"".concat(e/1024," M"):"".concat(e," KB")))}else c()}else c()}}}function k(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{accept:K.\u56FE\u7247},e=u.accept;return{validator:function(n,i,c){if(i&&i.length){var m=i.filter(function(l){return!L(l,e)});if(m.length){var v=m.map(function(l){return'"'.concat(l.name,'"')}).join(",");c("\u6587\u4EF6\uFF1A".concat(v,"\uFF0C\u6587\u4EF6\u7C7B\u578B\u4E0D\u7B26\u5408\u8981\u6C42"))}else c()}else c()}}}function q(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{maxCount:h},e=u.maxCount;return{validator:function(n,i,c){i&&i.length&&i.length>e?c("\u6587\u4EF6\u4E2A\u6570\u8D85\u8FC7 ".concat(e," \u4E2A!")):c()}}}var G=function(e){var t=Object.keys(e).filter(function(n){return!!e[n]});return t.map(function(n){return e[n]===!0?H[n]():H[n]((0,g.Z)({},n,e[n]))})};function de(u){return u&&u.length>0?u.map(function(e){var t=e.fileId,n=e.fileName,i=e.fileUrl,c=_objectWithoutProperties(e,["fileId","fileName","fileUrl"]);return _objectSpread(_objectSpread({},c),{},{uid:t,status:"done",size:0,type:"",name:n||D(t),url:i,response:{success:!0,data:{fileId:t,fileName:n||D(t),url:i}}})}):[]}function ce(u){return u&&u.length>0?u.map(function(e){var t=e.response.data,n=t.fileId,i=t.fileName,c=t.url;return{fileId:n,fileName:i,fileUrl:c,type:""}}):[]}var me=function(e){return"".concat(a,"/file/preview?fileId=").concat(e)}},42348:function(x,F,r){"use strict";r.d(F,{tH:function(){return f},Le:function(){return S},ZG:function(){return N}});var g=r(4137),f=function(d,s,o){s&&!(0,g.Mn)(s)?o("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u7535\u8BDD\u53F7\u7801"):o()},S=function(d,s,o){s&&!(0,g.Jh)(s)?o("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u90AE\u7BB1"):o()},T=function(d,s,o){s&&!/^(?=.*[a-zA-Z\W_])(?=.*[0-9]).{8,20}$/.test(s)?o("\u75318-20\u4E2A\u6570\u5B57+\u5B57\u6BCD\u6216\u7B26\u53F7\u7EC4\u6210\uFF0C\u4E0D\u53EF\u7EAF\u6570\u5B57"):o()},p=function(d,s,o){s&&!/^[\u4e00-\u9fa5a-zA-Z]{2,20}$/.test(s)?o("\u75312-20\u4E2A\u4E2D\u6587\u6216\u82F1\u6587\u7EC4\u6210"):o()},N=function(d){return function(s,o,a){o&&o!==d?a("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4"):a()}},I={phoneValidator:f,checkPassword:T,checkNickName:p}}}]);
